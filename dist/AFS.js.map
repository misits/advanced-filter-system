{"version":3,"file":"AFS.js","sources":["../src/AFS.js"],"sourcesContent":["/**\n * @fileoverview Advanced Filter System for DOM elements\n * @version 1.0.0\n *\n * A flexible and customizable filtering system that supports:\n * - Multiple filtering modes (OR/AND)\n * - Text search with debouncing\n * - Multiple sorting criteria\n * - Range filtering\n * - URL state management\n * - Animation and transitions\n * - Results counter\n */\n\n/**\n * Utility function for debouncing\n * @param {Function} func - Function to debounce\n * @param {number} wait - Delay in milliseconds\n * @returns {Function} Debounced function\n */\nfunction debounce(func, wait) {\n    let timeout;\n    return function executedFunction(...args) {\n        const later = () => {\n            clearTimeout(timeout);\n            func(...args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n    };\n}\n\nclass AFS {\n    /**\n     * @typedef {Object} FilterOptions\n     * @property {string} containerSelector - Main container selector\n     * @property {string} itemSelector - Items to filter selector\n     * @property {string} filterButtonSelector - Filter buttons selector\n     * @property {string} [searchInputSelector] - Search input selector\n     * @property {string} [counterSelector] - Results counter selector\n     * @property {string} [activeClass='active'] - Active state class\n     * @property {string} [hiddenClass='hidden'] - Hidden state class\n     * @property {number} [animationDuration=300] - Animation duration in ms\n     * @property {string} [filterMode='OR'] - Filter mode ('OR' or 'AND')\n     * @property {string[]} [searchKeys=['title']] - Data attributes to search in\n     * @property {number} [debounceTime=300] - Search debounce delay in ms\n     */\n\n    /**\n     * @param {FilterOptions} options - Filter configuration options\n     */\n    constructor(options = {}) {\n        this.options = {\n            containerSelector: \".filter-container\",\n            itemSelector: \".filter-item\",\n            filterButtonSelector: \".btn-filter\",\n            searchInputSelector: \".filter-search\",\n            counterSelector: \".filter-counter\",\n            activeClass: \"active\",\n            hiddenClass: \"hidden\",\n            animationDuration: 300,\n            filterMode: \"OR\",\n            searchKeys: [\"title\"],\n            debounceTime: 300,\n            ...options,\n        };\n\n        // Initialize elements\n        this.container = document.querySelector(this.options.containerSelector);\n        this.items = document.querySelectorAll(this.options.itemSelector);\n        this.filterButtons = document.querySelectorAll(\n            this.options.filterButtonSelector,\n        );\n        this.searchInput = document.querySelector(\n            this.options.searchInputSelector,\n        );\n        this.counter = document.querySelector(this.options.counterSelector);\n\n        // Initialize state\n        this.currentFilters = new Set([\"*\"]);\n        this.currentSearch = \"\";\n        this.visibleItems = new Set(this.items);\n\n        this.init();\n    }\n\n    /**\n     * Initialize the filter system\n     * @private\n     */\n    init() {\n        this.addStyles();\n        this.bindEvents();\n        this.loadFromURL();\n        this.updateCounter();\n    }\n\n    /**\n     * Add required styles to document\n     * @private\n     */\n    addStyles() {\n        const styles = `\n            .${this.options.hiddenClass} {\n                display: none !important;\n            }\n\n            ${this.options.itemSelector} {\n                opacity: 1;\n                transform: scale(1);\n                transition: opacity ${this.options.animationDuration}ms ease-out,\n                            transform ${this.options.animationDuration}ms ease-out;\n            }\n\n            ${this.options.filterButtonSelector} {\n                opacity: 0.5;\n                transition: opacity ${this.options.animationDuration}ms ease;\n            }\n\n            ${this.options.filterButtonSelector}.${this.options.activeClass} {\n                opacity: 1;\n            }\n        `;\n\n        const styleSheet = document.createElement(\"style\");\n        styleSheet.textContent = styles;\n        document.head.appendChild(styleSheet);\n    }\n\n    /**\n     * Bind all event listeners\n     * @private\n     */\n    bindEvents() {\n        this.filterButtons.forEach((button) => {\n            button.addEventListener(\"click\", () =>\n                this.handleFilterClick(button),\n            );\n        });\n\n        if (this.searchInput) {\n            this.searchInput.addEventListener(\n                \"input\",\n                debounce((e) => {\n                    this.search(e.target.value);\n                }, this.options.debounceTime),\n            );\n        }\n\n        window.addEventListener(\"popstate\", () => this.loadFromURL());\n    }\n\n    /**\n     * Handle filter button clicks\n     * @private\n     * @param {HTMLElement} button - Clicked filter button\n     */\n    handleFilterClick(button) {\n        const filterValue = button.dataset.filter;\n\n        if (filterValue === \"*\") {\n            this.resetFilters();\n        } else {\n            this.toggleFilter(filterValue, button);\n        }\n\n        this.filter();\n        this.updateURL();\n    }\n\n    /**\n     * Reset all filters to default state\n     * @private\n     */\n    resetFilters() {\n        this.filterButtons.forEach((btn) =>\n            btn.classList.remove(this.options.activeClass),\n        );\n        this.currentFilters.clear();\n        this.currentFilters.add(\"*\");\n        this.filterButtons[0].classList.add(this.options.activeClass);\n        this.resetCounter();\n    }\n\n    /**\n     * Reset visible items counter\n     * @private\n     */\n    resetCounter() {\n        this.visibleItems = new Set(this.items);\n        this.updateCounter();\n    }\n\n    /**\n     * Toggle individual filter state\n     * @private\n     * @param {string} filterValue - Filter value to toggle\n     * @param {HTMLElement} button - Filter button element\n     */\n    toggleFilter(filterValue, button) {\n        this.currentFilters.delete(\"*\");\n        this.filterButtons[0].classList.remove(this.options.activeClass);\n\n        if (button.classList.contains(this.options.activeClass)) {\n            button.classList.remove(this.options.activeClass);\n            this.currentFilters.delete(filterValue);\n\n            if (this.currentFilters.size === 0) {\n                this.resetFilters();\n            }\n        } else {\n            button.classList.add(this.options.activeClass);\n            this.currentFilters.add(filterValue);\n        }\n    }\n\n    /**\n     * Apply current filters to items\n     * @public\n     */\n    filter() {\n        this.visibleItems.clear(); // Start with an empty set\n\n        this.items.forEach((item) => {\n            if (this.currentFilters.has(\"*\")) {\n                this.showItem(item);\n                this.visibleItems.add(item); // Add visible item to the set\n            } else {\n                const itemCategories = new Set(\n                    item.dataset.categories?.split(\" \") || [],\n                );\n                const matchesFilter =\n                    this.options.filterMode === \"OR\"\n                        ? this.matchesAnyFilter(itemCategories)\n                        : this.matchesAllFilters(itemCategories);\n\n                if (matchesFilter) {\n                    this.showItem(item);\n                    this.visibleItems.add(item); // Add visible item to the set\n                } else {\n                    this.hideItem(item);\n                }\n            }\n        });\n\n        setTimeout(() => {\n            this.updateCounter();\n        }, this.options.animationDuration);\n    }\n\n    /**\n     * Check if item matches any active filter (OR mode)\n     * @private\n     * @param {Set} itemCategories - Item's categories\n     * @returns {boolean} Whether item matches any filter\n     */\n    matchesAnyFilter(itemCategories) {\n        return [...this.currentFilters].some((filter) => {\n            const [type, value] = filter.split(\":\");\n            return itemCategories.has(`${type}:${value}`);\n        });\n    }\n\n    /**\n     * Check if item matches all active filters (AND mode)\n     * @private\n     * @param {Set} itemCategories - Item's categories\n     * @returns {boolean} Whether item matches all filters\n     */\n    matchesAllFilters(itemCategories) {\n        return [...this.currentFilters].every((filter) => {\n            const [type, value] = filter.split(\":\");\n            return itemCategories.has(`${type}:${value}`);\n        });\n    }\n\n    /**\n     * Show an item with animation\n     * @private\n     * @param {HTMLElement} item - Item to show\n     */\n    showItem(item) {\n        this.visibleItems.add(item);\n        item.classList.remove(this.options.hiddenClass);\n        item.style.opacity = \"0\";\n        item.style.transform = \"scale(0.95)\";\n\n        item.offsetHeight;\n\n        requestAnimationFrame(() => {\n            item.style.opacity = \"1\";\n            item.style.transform = \"scale(1)\";\n        });\n    }\n\n    /**\n     * Hide an item with animation\n     * @private\n     * @param {HTMLElement} item - Item to hide\n     */\n    hideItem(item) {\n        item.style.opacity = \"0\";\n        item.style.transform = \"scale(0.95)\";\n\n        setTimeout(() => {\n            if (item.style.opacity === \"0\") {\n                item.classList.add(this.options.hiddenClass);\n                this.visibleItems.delete(item);\n            }\n        }, this.options.animationDuration);\n    }\n\n    /**\n     * Search items by text\n     * @public\n     * @param {string} query - Search query\n     */\n    search(query) {\n        this.currentSearch = query.toLowerCase().trim();\n        let matches = 0;\n\n        this.items.forEach((item) => {\n            const searchText = this.options.searchKeys\n                .map((key) => item.dataset[key] || \"\")\n                .join(\" \")\n                .toLowerCase();\n\n            const matchesSearch =\n                this.currentSearch === \"\" ||\n                searchText.includes(this.currentSearch);\n\n            if (matchesSearch) {\n                this.showItem(item);\n                matches++;\n            } else {\n                this.hideItem(item);\n            }\n        });\n\n        this.updateURL();\n\n        setTimeout(() => {\n            this.updateCounter();\n        }, this.options.animationDuration);\n    }\n\n    /**\n     * Sort items by multiple criteria\n     * @public\n     * @param {Array<{key: string, direction: string}>} criteria - Sort criteria\n     */\n    sortMultiple(criteria) {\n        const items = [...this.items];\n\n        items.sort((a, b) => {\n            for (const criterion of criteria) {\n                const valueA = a.dataset[criterion.key];\n                const valueB = b.dataset[criterion.key];\n\n                const comparison =\n                    criterion.direction === \"asc\"\n                        ? valueA.localeCompare(valueB)\n                        : valueB.localeCompare(valueA);\n\n                if (comparison !== 0) return comparison;\n            }\n            return 0;\n        });\n\n        items.forEach((item) => this.container.appendChild(item));\n    }\n\n    /**\n     * Filter items by numeric range\n     * @public\n     * @param {string} key - Data attribute key\n     * @param {number} min - Minimum value\n     * @param {number} max - Maximum value\n     */\n    addRangeFilter(key, min, max) {\n        this.items.forEach((item) => {\n            const value = parseFloat(item.dataset[key]);\n            const inRange = value >= min && value <= max;\n\n            if (inRange) {\n                this.showItem(item);\n            } else {\n                this.hideItem(item);\n            }\n        });\n\n        setTimeout(() => {\n            this.updateCounter();\n        }, this.options.animationDuration);\n    }\n\n    /**\n     * Update URL with current filter state\n     * @private\n     */\n    updateURL() {\n        const params = new URLSearchParams();\n\n        // Séparer les filtres par type\n        const filtersByType = {};\n        for (const filter of this.currentFilters) {\n            if (filter !== \"*\") {\n                const [type, value] = filter.split(\":\");\n                if (!filtersByType[type]) {\n                    filtersByType[type] = new Set();\n                }\n                filtersByType[type].add(value);\n            }\n        }\n\n        // Ajouter chaque type de filtre à l'URL\n        Object.entries(filtersByType).forEach(([type, values]) => {\n            params.set(type, Array.from(values).join(\",\"));\n        });\n\n        if (this.currentSearch) {\n            params.set(\"search\", this.currentSearch);\n        }\n\n        const newURL = `${window.location.pathname}${\n            params.toString() ? \"?\" + params.toString() : \"\"\n        }`;\n        window.history.pushState({}, \"\", newURL);\n    }\n\n    /**\n     * Load filter state from URL\n     * @private\n     */\n    loadFromURL() {\n        const params = new URLSearchParams(window.location.search);\n        this.currentFilters.clear();\n\n        // Si aucun filtre n'est présent, utiliser '*'\n        let hasFilters = false;\n\n        // Parcourir tous les paramètres\n        for (const [type, values] of params.entries()) {\n            if (type !== \"search\") {\n                hasFilters = true;\n                values.split(\",\").forEach((value) => {\n                    this.currentFilters.add(`${type}:${value}`);\n                });\n            }\n        }\n\n        if (!hasFilters) {\n            this.currentFilters.add(\"*\");\n        }\n\n        // Update active buttons\n        this.filterButtons.forEach((button) => {\n            const filterValue = button.dataset.filter;\n            if (\n                this.currentFilters.has(filterValue) ||\n                (filterValue === \"*\" && this.currentFilters.has(\"*\"))\n            ) {\n                button.classList.add(this.options.activeClass);\n            } else {\n                button.classList.remove(this.options.activeClass);\n            }\n        });\n\n        // Load search\n        const search = params.get(\"search\") || \"\";\n        if (this.searchInput) {\n            this.searchInput.value = search;\n        }\n\n        this.filter();\n        if (search) {\n            this.search(search);\n        }\n    }\n\n    /**\n     * Update results counter\n     * @private\n     * @returns {{total: number, visible: number}}\n     */\n    updateCounter() {\n        const total = this.items.length;\n        const visible = this.visibleItems.size;\n\n        if (this.counter) {\n            this.counter.textContent = `Showing ${visible} of ${total}`;\n        }\n\n        return { total, visible };\n    }\n\n    /**\n     * Change filter mode\n     * @public\n     * @param {string} mode - New filter mode ('OR' or 'AND')\n     */\n    setFilterMode(mode) {\n        if ([\"OR\", \"AND\"].includes(mode.toUpperCase())) {\n            this.options.filterMode = mode.toUpperCase();\n            this.filter();\n        }\n    }\n\n    /**\n     * Add filter by type and value\n     * @public\n     * @param {string} type - Filter type\n     * @param {string} value - Filter value\n     */\n    addFilter(type, value) {\n        this.currentFilters.add(`${type}:${value}`);\n        this.filter();\n        this.updateURL();\n    }\n\n    /**\n     * Remove filter by type and value\n     * @public\n     * @param {string} type - Filter type\n     */\n    removeFilter(type, value) {\n        this.currentFilters.delete(`${type}:${value}`);\n        if (this.currentFilters.size === 0) {\n            this.currentFilters.add(\"*\");\n        }\n        this.filter();\n        this.updateURL();\n    }\n\n    /**\n     * Get active filters by type\n     * @public\n     * @param {string} type - Filter type\n     */\n    getActiveFiltersByType(type) {\n        return [...this.currentFilters]\n            .filter((filter) => filter.startsWith(`${type}:`))\n            .map((filter) => filter.split(\":\")[1]);\n    }\n}\n\nexport { AFS };\n"],"names":["debounce","func","wait","timeout","executedFunction","_len","arguments","length","args","Array","_key","later","clearTimeout","setTimeout","AFS","constructor","options","undefined","containerSelector","itemSelector","filterButtonSelector","searchInputSelector","counterSelector","activeClass","hiddenClass","animationDuration","filterMode","searchKeys","debounceTime","container","document","querySelector","items","querySelectorAll","filterButtons","searchInput","counter","currentFilters","Set","currentSearch","visibleItems","init","addStyles","bindEvents","loadFromURL","updateCounter","styles","styleSheet","createElement","textContent","head","appendChild","forEach","button","addEventListener","handleFilterClick","e","search","target","value","window","filterValue","dataset","filter","resetFilters","toggleFilter","updateURL","btn","classList","remove","clear","add","resetCounter","delete","contains","size","item","has","showItem","itemCategories","categories","split","matchesFilter","matchesAnyFilter","matchesAllFilters","hideItem","some","type","every","style","opacity","transform","offsetHeight","requestAnimationFrame","query","toLowerCase","trim","searchText","map","key","join","matchesSearch","includes","sortMultiple","criteria","sort","a","b","criterion","valueA","valueB","comparison","direction","localeCompare","addRangeFilter","min","max","parseFloat","inRange","params","URLSearchParams","filtersByType","Object","entries","_ref","values","set","from","newURL","location","pathname","toString","history","pushState","hasFilters","get","total","visible","setFilterMode","mode","toUpperCase","addFilter","removeFilter","getActiveFiltersByType","startsWith"],"mappings":"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"}