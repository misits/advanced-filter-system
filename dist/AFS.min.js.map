{"version":3,"file":"AFS.min.js","sources":["../src/core/Logger.js","../src/core/Options.js","../src/core/State.js","../src/styles/StyleManager.js","../src/core/EventEmitter.js","../src/styles/Animation.js","../src/features/Filter.js","../src/utils/index.js","../src/features/Search.js","../src/features/Sort.js","../src/features/Pagination.js","../src/features/URLManager.js","../src/features/RangeFilter.js","../src/features/DateFilter.js","../src/AFS.js"],"sourcesContent":["/**\n * @fileoverview Logging system for AFS\n * @version 1.0.0\n */\n\nexport class Logger {\n  /**\n   * @param {boolean} [debug=false] - Enable debug mode\n   * @param {string} [logLevel='info'] - Logging level\n   */\n  constructor(debug = false, logLevel = 'info') {\n    this.enabled = debug;\n    this.level = logLevel;\n    this.levels = {\n      error: 0,\n      warn: 1,\n      info: 2,\n      debug: 3\n    };\n  }\n\n  /**\n   * Internal log method\n   * @private\n   */\n  _log(level, ...args) {\n    if (!this.enabled) return;\n\n    const currentLevelValue = this.levels[this.level];\n    const messageLevel = this.levels[level];\n\n    if (messageLevel <= currentLevelValue) {\n      const timestamp = new Date().toISOString();\n      const prefix = `[AFS ${level.toUpperCase()}] ${timestamp}`;\n\n      switch (level) {\n        case 'error':\n          console.error(prefix, ...args);\n          break;\n        case 'warn':\n          console.warn(prefix, ...args);\n          break;\n        case 'info':\n          console.info(prefix, ...args);\n          break;\n        case 'debug':\n          console.debug(prefix, ...args);\n          break;\n      }\n    }\n  }\n\n  /**\n   * Log error message\n   * @public\n   */\n  error(...args) {\n    this._log('error', ...args);\n  }\n\n  /**\n   * Log warning message\n   * @public\n   */\n  warn(...args) {\n    this._log('warn', ...args);\n  }\n\n  /**\n   * Log info message\n   * @public\n   */\n  info(...args) {\n    this._log('info', ...args);\n  }\n\n  /**\n   * Log debug message\n   * @public\n   */\n  debug(...args) {\n    this._log('debug', ...args);\n  }\n\n  /**\n   * Enable or disable debug mode\n   * @public\n   */\n  setDebugMode(enabled, level = 'info') {\n    this.enabled = enabled;\n    if (this.levels.hasOwnProperty(level)) {\n      this.level = level;\n    }\n    this._log('info', `Debug mode ${enabled ? 'enabled' : 'disabled'} with level: ${level}`);\n  }\n}","/**\n * @fileoverview Configuration management for AFS\n * @version 1.0.0\n */\n\nexport class Options {\n  /**\n   * @typedef {Object} AFSOptions\n   * @property {string} containerSelector - Main container selector\n   * @property {string} itemSelector - Items to filter selector\n   * @property {string} filterButtonSelector - Filter buttons selector\n   * @property {string} searchInputSelector - Search input selector\n   * @property {string} counterSelector - Results counter selector\n   * @property {string} activeClass - Active state class\n   * @property {string} hiddenClass - Hidden state class\n   * @property {number} animationDuration - Animation duration in ms\n   * @property {string} filterMode - Filter mode ('OR' or 'AND')\n   * @property {string[]} searchKeys - Data attributes to search in\n   * @property {number} debounceTime - Search debounce delay in ms\n   * @property {boolean} debug - Enable debug mode\n   * @property {string} logLevel - Log level\n   * @property {string} dateFormat - Date format\n   * @property {Object} counter - Counter-related options\n   * @property {Object} styles - Style-related options\n   */\n\n  /**\n   * @type {AFSOptions}\n   */\n  static defaults = {\n    // Selectors\n    containerSelector: '.filter-container',\n    itemSelector: '.filter-item',\n    filterButtonSelector: '.btn-filter',\n    searchInputSelector: '.filter-search',\n    counterSelector: '.filter-counter',\n\n    // Classes\n    activeClass: 'active',\n    hiddenClass: 'hidden',\n\n    // Animation\n    animationDuration: 300,\n    animationType: 'fade',\n    animationEasing: 'ease-out',\n\n    // Filtering\n    filterMode: 'OR',\n    searchKeys: ['title'],\n    debounceTime: 300,\n\n    // Debug\n    debug: false,\n    logLevel: 'info',\n\n    // Date handling\n    dateFormat: 'YYYY-MM-DD',\n\n    counter: {\n      template: 'Showing {visible} of {total}',\n      showFiltered: true,\n      filteredTemplate: '({filtered} filtered)',\n      noResultsTemplate: 'No items found',\n      formatter: (num) => num.toLocaleString()\n    },\n\n    // Styles\n    styles: {\n      slider: {\n        class: 'afs-range-slider',\n        trackClass: 'afs-range-track',\n        thumbClass: 'afs-range-thumb',\n        valueClass: 'afs-range-value',\n        selectedClass: 'afs-range-selected',\n        // Add new UI options\n        ui: {\n          showHistogram: false,\n          bins: 10 // Number of bins for histogram\n        }\n      },\n      colors: {\n        primary: '#000',\n        background: '#e5e7eb',\n        text: '#000',\n        histogram: '#e5e7eb', // For histogram bars\n        histogramActive: '#000' // For active histogram bars\n      }\n    },\n\n    // Pagination\n    pagination: {\n      enabled: false,\n      itemsPerPage: 10,\n      pageButtonClass: 'afs-page-button',\n      activePageClass: 'afs-page-active',\n      containerClass: 'afs-pagination'\n    }\n  };\n\n  constructor(userOptions = {}) {\n    this.options = this.mergeOptions(Options.defaults, userOptions);\n    this.initializeStyles();\n    this.validate();\n  }\n\n  /**\n   * Initialize styles with defaults\n   * @private\n   */\n  initializeStyles() {\n    const defaultStyles = Options.defaults.styles;\n    const currentStyles = this.options.styles || {};\n\n    this.options.styles = this.mergeOptions(defaultStyles, currentStyles);\n\n    // Ensure colors object exists and has all required properties\n    this.options.styles.colors = {\n      ...defaultStyles.colors,\n      ...(currentStyles.colors || {})\n    };\n}\n\n  /**\n   * Deep merge options\n   * @private\n   * @param {Object} target - Target object\n   * @param {Object} source - Source object\n   * @returns {Object} Merged options\n   */\n  mergeOptions(target, source) {\n    const result = { ...target };\n  \n    for (const key in source) {\n      if (source[key] !== null && typeof source[key] === 'object' && !Array.isArray(source[key])) {\n        // If the key doesn't exist in target or isn't an object, create/override it\n        if (!target[key] || typeof target[key] !== 'object') {\n          result[key] = {};\n        }\n        // Recursively merge nested objects\n        result[key] = this.mergeOptions(result[key], source[key]);\n      } else if (source[key] !== undefined) {\n        // Only override if the source value is defined\n        result[key] = source[key];\n      }\n    }\n  \n    return result;\n  }\n\n  /**\n   * Validate options\n   * @private\n   * @throws {Error} If options are invalid\n   */\n  validate() {\n    // Required selectors\n    const requiredSelectors = ['containerSelector', 'itemSelector'];\n    for (const selector of requiredSelectors) {\n      if (typeof this.options[selector] !== 'string') {\n        throw new Error(`${selector} must be a string`);\n      }\n    }\n\n    // Animation duration\n    if (typeof this.options.animationDuration !== 'number' || this.options.animationDuration < 0) {\n      throw new Error('animationDuration must be a positive number');\n    }\n\n    // Filter mode\n    if (!['OR', 'AND'].includes(this.options.filterMode.toUpperCase())) {\n      throw new Error('filterMode must be either \"OR\" or \"AND\"');\n    }\n\n    // Search keys\n    if (!Array.isArray(this.options.searchKeys) || this.options.searchKeys.length === 0) {\n      throw new Error('searchKeys must be a non-empty array');\n    }\n\n    // Counter validation\n    if (this.options.counter) {\n      if (typeof this.options.counter.template !== 'string') {\n        throw new Error('counter.template must be a string');\n      }\n      if (typeof this.options.counter.showFiltered !== 'boolean') {\n        this.options.counter.showFiltered = true; // Set default\n      }\n      if (typeof this.options.counter.formatter !== 'function') {\n        this.options.counter.formatter = (num) => num.toLocaleString(); // Set default\n      }\n    } else {\n      this.options.counter = { ...Options.defaults.counter }; // Set defaults if missing\n    }\n  }\n\n  /**\n   * Get option value\n   * @param {string} path - Dot notation path to option\n   * @returns {any} Option value\n   */\n  get(path) {\n    return path.split('.').reduce((obj, key) => obj?.[key], this.options);\n  }\n\n  /**\n   * Set option value\n   * @param {string} path - Dot notation path to option\n   * @param {any} value - New value\n   */\n  set(path, value) {\n    const parts = path.split('.');\n    const last = parts.pop();\n    const target = parts.reduce((obj, key) => {\n      if (!(key in obj)) obj[key] = {};\n      return obj[key];\n    }, this.options);\n\n    target[last] = value;\n    this.validate();\n  }\n\n  /**\n   * Update multiple options\n   * @param {Object} updates - Options to update\n   */\n  update(updates) {\n    this.options = this.mergeOptions(this.options, updates);\n    this.validate();\n  }\n\n  /**\n   * Reset options to defaults\n   */\n  reset() {\n    this.options = { ...Options.defaults };\n  }\n\n  /**\n   * Export options\n   * @returns {Object} Current options\n   */\n  export() {\n    return { ...this.options };\n  }\n}","/**\n * @fileoverview State management for AFS\n * @version 1.0.0\n */\n\nexport class State {\n  constructor() {\n    this.state = {\n      filters: {\n        current: new Set(['*']),\n        groups: new Map(),\n        ranges: new Map(),\n        dateRanges: new Map(),\n        mode: 'OR',\n        groupMode: 'OR'\n      },\n      search: {\n        query: '',\n        keys: ['title']\n      },\n      sort: {\n        orders: {},\n        current: null\n      },\n      items: {\n        visible: new Set(),\n        total: 0\n      },\n      pagination: {\n        currentPage: 1,\n        itemsPerPage: 10,\n        totalPages: 0\n      }\n    };\n  }\n\n  /**\n   * Get current state\n   * @returns {Object} Current state\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Update state\n   * @param {string} path - Dot notation path to update\n   * @param {any} value - New value\n   */\n  setState(path, value) {\n    const parts = path.split('.');\n    let current = this.state;\n    \n    for (let i = 0; i < parts.length - 1; i++) {\n      if (!(parts[i] in current)) {\n        current[parts[i]] = {};\n      }\n      current = current[parts[i]];\n    }\n    \n    current[parts[parts.length - 1]] = value;\n  }\n\n  /**\n   * Export state\n   * @returns {Object} Exportable state\n   */\n  export() {\n    return {\n      filters: {\n        current: Array.from(this.state.filters.current),\n        groups: Array.from(this.state.filters.groups.entries()),\n        ranges: Array.from(this.state.filters.ranges.entries()),\n        dateRanges: Array.from(this.state.filters.dateRanges.entries()),\n        mode: this.state.filters.mode,\n        groupMode: this.state.filters.groupMode\n      },\n      search: { ...this.state.search },\n      sort: { ...this.state.sort },\n      pagination: { ...this.state.pagination }\n    };\n  }\n\n  /**\n   * Import state\n   * @param {Object} importedState - State to import\n   */\n  import(importedState) {\n    if (importedState.filters) {\n      this.state.filters.current = new Set(importedState.filters.current);\n      this.state.filters.groups = new Map(importedState.filters.groups);\n      this.state.filters.ranges = new Map(importedState.filters.ranges);\n      this.state.filters.dateRanges = new Map(importedState.filters.dateRanges);\n      this.state.filters.mode = importedState.filters.mode;\n      this.state.filters.groupMode = importedState.filters.groupMode;\n    }\n\n    if (importedState.search) {\n      this.state.search = { ...importedState.search };\n    }\n\n    if (importedState.sort) {\n      this.state.sort = { ...importedState.sort };\n    }\n\n    if (importedState.pagination) {\n      this.state.pagination = { ...importedState.pagination };\n    }\n  }\n\n  /**\n   * Reset state to initial values\n   */\n  reset() {\n    this.state = {\n      filters: {\n        current: new Set(['*']),\n        groups: new Map(),\n        ranges: new Map(),\n        dateRanges: new Map(),\n        mode: 'OR',\n        groupMode: 'OR'\n      },\n      search: {\n        query: '',\n        keys: ['title']\n      },\n      sort: {\n        orders: {},\n        current: null\n      },\n      items: {\n        visible: new Set(),\n        total: 0\n      },\n      pagination: {\n        currentPage: 1,\n        itemsPerPage: 10,\n        totalPages: 0\n      }\n    };\n  }\n}","/**\n * @fileoverview Style management for AFS\n * @version 1.0.0\n */\n\nexport class StyleManager {\n  /**\n   * @param {import('../core/Options').Options} options - Options instance\n   */\n  constructor(options) {\n    this.options = options;\n    this.styleElement = null;\n    this.defaultStyles = {\n      slider: {\n        class: \"afs-range-slider\",\n        trackClass: \"afs-range-track\",\n        thumbClass: \"afs-range-thumb\",\n        valueClass: \"afs-range-value\",\n        selectedClass: \"afs-range-selected\",\n      },\n      colors: {\n        primary: \"#000\",\n        background: \"#ddd\",\n        text: \"#000\",\n      },\n      animation: {\n        duration: \"300ms\",\n        type: \"ease-out\",\n      },\n    };\n  }\n\n  /**\n   * Create base styles\n   * @private\n   * @returns {string} CSS styles\n   */\n  createBaseStyles() {\n    const hiddenClass = this.options.get(\"hiddenClass\") || \"hidden\";\n    const itemSelector = this.options.get(\"itemSelector\") || \".filter-item\";\n    const filterButtonSelector = this.options.get(\"filterButtonSelector\") || \".btn-filter\";\n    const activeClass = this.options.get(\"activeClass\") || \"active\";\n    const animationDuration = this.options.get(\"animationDuration\") || '300ms';\n    const animationEasing = this.options.get(\"animationEasing\") || 'ease-out';\n    \n    return `\n      .${hiddenClass} {\n        display: none !important;\n      }\n\n      ${itemSelector} {\n        opacity: 1;\n        transform: scale(1);\n        filter: blur(0);\n        transition: opacity ${animationDuration} ${animationEasing},\n                    transform ${animationDuration} ${animationEasing},\n                    filter ${animationDuration} ${animationEasing};\n      }\n\n      ${itemSelector}.${hiddenClass} {\n        opacity: 0;\n        transform: scale(0.95);\n        filter: blur(5px);\n      }\n\n      ${filterButtonSelector} {\n        opacity: 0.5;\n        transition: opacity ${animationDuration} ${animationEasing};\n      }\n\n      ${filterButtonSelector}.${activeClass} {\n        opacity: 1;\n      }\n    `;\n}\n\n  /**\n   * Create range slider styles\n   * @private\n   * @returns {string} CSS styles\n   */\n  createRangeStyles() {\n    const styles = this.options.get(\"styles\") || this.defaultStyles;\n    const sliderStyles = styles.slider || this.defaultStyles.slider;\n    const colors = styles.colors || this.defaultStyles.colors;\n\n    return `\n    /* Range Slider Styles */\n    .${sliderStyles.class} {\n      position: relative;\n      width: auto;\n      height: 40px;\n      margin: 10px 0;\n      padding: 0 8px;\n    }\n\n    .${sliderStyles.trackClass} {\n      position: absolute;\n      top: 50%;\n      transform: translateY(-50%);\n      width: 100%;\n      height: 4px;\n      background: ${colors.background};\n      border-radius: 2px;\n    }\n\n    .${sliderStyles.thumbClass} {\n      position: absolute;\n      top: 50%;\n      width: 16px;\n      height: 16px;\n      background: ${colors.primary};\n      border-radius: 50%;\n      transform: translate(-50%, -50%);\n      cursor: pointer;\n      z-index: 2;\n    }\n\n    .${sliderStyles.valueClass} {\n      position: absolute;\n      top: -20px;\n      transform: translateX(-50%);\n      font-size: 10px;\n      color: ${colors.text};\n    }\n\n    .${sliderStyles.selectedClass} {\n      position: absolute;\n      height: 4px;\n      background: ${colors.primary};\n      top: 50%;\n      transform: translateY(-50%);\n    }\n\n    /* Histogram Styles */\n    .afs-histogram {\n      position: absolute;\n      bottom: 22px;\n      left: 8px;\n      right: 8px;\n      height: 20px;\n      display: flex;\n      align-items: flex-end;\n      gap: 1px;\n      opacity: 0.5;\n    }\n\n    .afs-histogram-bar {\n      flex: 1;\n      background-color: ${colors.background};\n      min-height: 4px;\n      transition: background-color 0.2s ease;\n    }\n\n    .afs-histogram-bar.active {\n      background-color: ${colors.primary};\n    }\n  `;\n  }\n\n  /**\n   * Create date filter styles\n   * @private\n   * @returns {string} CSS styles\n   */\n  createDateStyles() {\n    const colors = (this.options.get(\"styles\") || this.defaultStyles).colors;\n\n    return `\n    .afs-date-range-container {\n      display: flex;\n      flex-wrap: wrap;\n      gap: 1rem;\n      margin: 10px 0;\n    }\n\n    .afs-date-input-wrapper {\n      flex: 1;\n    }\n\n    .afs-date-input-wrapper label {\n      display: block;\n      font-size: 0.875rem;\n      color: ${colors.text};\n      margin-bottom: 0.5rem;\n    }\n\n    .afs-date-input {\n      width: 100%;\n      padding: 0.5rem;\n      border: 1px solid ${colors.background};\n      border-radius: 0.25rem;\n      font-size: 0.875rem;\n      color: ${colors.text};\n      transition: border-color 0.2s ease;\n    }\n\n    .afs-date-input:focus {\n      outline: none;\n      border-color: ${colors.primary};\n    }\n  `;\n  }\n\n  /**\n   * Apply all styles\n   * @public\n   */\n  applyStyles() {\n    try {\n      const styles = `\n      /* Base styles */\n      ${this.createBaseStyles()}\n\n      /* Range slider styles */\n      ${this.createRangeStyles()}\n\n      /* Date filter styles */\n      ${this.createDateStyles()}\n\n      /* Pagination styles */\n      ${this.createPaginationStyles()}\n\n      /* Search styles */\n      ${this.createSearchStyles()}\n    `;\n\n      if (this.styleElement) {\n        this.styleElement.textContent = styles;\n      } else {\n        this.styleElement = document.createElement(\"style\");\n        this.styleElement.textContent = styles;\n        document.head.appendChild(this.styleElement);\n      }\n    } catch (error) {\n      console.error(\"Error applying styles:\", error);\n      const fallbackStyles = this.createBaseStyles();\n      if (this.styleElement) {\n        this.styleElement.textContent = fallbackStyles;\n      } else {\n        this.styleElement = document.createElement(\"style\");\n        this.styleElement.textContent = fallbackStyles;\n        document.head.appendChild(this.styleElement);\n      }\n    }\n  }\n\n  /**\n   * Create pagination styles\n   * @private\n   * @returns {string} CSS styles\n   */\n  createPaginationStyles() {\n    const paginationOptions = this.options.get(\"pagination\") || {};\n    const colors = (this.options.get(\"styles\") || this.defaultStyles).colors;\n\n    const containerClass = paginationOptions.containerClass || \"afs-pagination\";\n    const buttonClass = paginationOptions.pageButtonClass || \"afs-page-button\";\n    const activeClass = paginationOptions.activePageClass || \"afs-page-active\";\n\n    return `\n      .${containerClass} {\n        display: flex;\n        justify-content: center;\n        gap: 8px;\n        margin-top: 20px;\n      }\n\n      .${buttonClass} {\n        padding: 8px 12px;\n        border: 1px solid ${colors.primary};\n        border-radius: 4px;\n        cursor: pointer;\n        transition: all 200ms ease-out;\n        background: transparent;\n        color: ${colors.primary};\n      }\n\n      .${buttonClass}:hover {\n        background: ${colors.primary};\n        color: white;\n      }\n\n      .${buttonClass}.${activeClass} {\n        background: ${colors.primary};\n        color: white;\n      }\n\n      .${buttonClass}:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n      }\n    `;\n  }\n\n  /**\n   * Create search styles\n   * @private\n   * @returns {string} CSS styles\n   */\n  createSearchStyles() {\n    const searchClass = this.options.get(\"searchInputClass\") || \"afs-search\";\n    const colors = (this.options.get(\"styles\") || this.defaultStyles).colors;\n\n    return `\n      .${searchClass} {\n        padding: 8px;\n        border: 1px solid ${colors.background};\n        border-radius: 4px;\n        width: 100%;\n        max-width: 300px;\n        transition: border-color 200ms ease-out;\n      }\n\n      .${searchClass}:focus {\n        outline: none;\n        border-color: ${colors.primary};\n      }\n    `;\n  }\n\n  /**\n   * Update styles\n   * @public\n   * @param {Object} newOptions - New style options\n   */\n  updateStyles(newOptions) {\n    this.options = newOptions;\n    this.applyStyles();\n  }\n\n  /**\n   * Remove styles\n   * @public\n   */\n  removeStyles() {\n    if (this.styleElement) {\n      this.styleElement.remove();\n      this.styleElement = null;\n    }\n  }\n}\n","/**\n * @fileoverview Event handling system for AFS\n * @version 1.0.0\n */\n\nexport class EventEmitter {\n  constructor() {\n    this.events = new Map();\n    this.onceEvents = new Map();\n  }\n\n  /**\n   * Subscribe to an event\n   * @param {string} eventName - Name of the event\n   * @param {Function} callback - Callback function\n   * @returns {Function} Unsubscribe function\n   */\n  on(eventName, callback) {\n    if (!this.events.has(eventName)) {\n      this.events.set(eventName, new Set());\n    }\n\n    this.events.get(eventName).add(callback);\n\n    // Return unsubscribe function\n    return () => this.off(eventName, callback);\n  }\n\n  /**\n   * Subscribe to an event once\n   * @param {string} eventName - Name of the event\n   * @param {Function} callback - Callback function\n   * @returns {Function} Unsubscribe function\n   */\n  once(eventName, callback) {\n    const onceWrapper = (...args) => {\n      this.off(eventName, onceWrapper);\n      callback.apply(this, args);\n    };\n\n    if (!this.onceEvents.has(eventName)) {\n      this.onceEvents.set(eventName, new Map());\n    }\n\n    this.onceEvents.get(eventName).set(callback, onceWrapper);\n    return this.on(eventName, onceWrapper);\n  }\n\n  /**\n   * Unsubscribe from an event\n   * @param {string} eventName - Name of the event\n   * @param {Function} callback - Callback function\n   */\n  off(eventName, callback) {\n    // Remove from regular events\n    if (this.events.has(eventName)) {\n      this.events.get(eventName).delete(callback);\n\n      // Cleanup if no more listeners\n      if (this.events.get(eventName).size === 0) {\n        this.events.delete(eventName);\n      }\n    }\n\n    // Remove from once events\n    if (this.onceEvents.has(eventName)) {\n      const onceWrapper = this.onceEvents.get(eventName).get(callback);\n      if (onceWrapper) {\n        this.events.get(eventName)?.delete(onceWrapper);\n        this.onceEvents.get(eventName).delete(callback);\n      }\n\n      // Cleanup if no more once listeners\n      if (this.onceEvents.get(eventName).size === 0) {\n        this.onceEvents.delete(eventName);\n      }\n    }\n  }\n\n  /**\n   * Emit an event\n   * @param {string} eventName - Name of the event\n   * @param {...any} args - Arguments to pass to callbacks\n   */\n  emit(eventName, ...args) {\n    if (this.events.has(eventName)) {\n      this.events.get(eventName).forEach(callback => {\n        try {\n          callback.apply(this, args);\n        } catch (error) {\n          console.error(`Error in event handler for ${eventName}:`, error);\n        }\n      });\n    }\n  }\n\n  /**\n   * Remove all event listeners\n   * @param {string} [eventName] - Optional event name to clear specific event\n   */\n  removeAllListeners(eventName) {\n    if (eventName) {\n      this.events.delete(eventName);\n      this.onceEvents.delete(eventName);\n    } else {\n      this.events.clear();\n      this.onceEvents.clear();\n    }\n  }\n\n  /**\n   * Get the number of listeners for an event\n   * @param {string} eventName - Name of the event\n   * @returns {number} Number of listeners\n   */\n  listenerCount(eventName) {\n    return (this.events.get(eventName)?.size || 0) + \n           (this.onceEvents.get(eventName)?.size || 0);\n  }\n}","export class Animation {\n    constructor(afs) {\n        this.afs = afs;\n        this.options = this.afs.options;\n        this.animations = {\n          fade: {\n            in: { opacity: 1, transform: 'scale(1)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'scale(0.95)', transitionTimingFunction: 'ease-out' },\n          },\n          slide: {\n            in: { opacity: 1, transform: 'translateY(0)', transitionTimingFunction: 'ease-in-out' },\n            out: { opacity: 0, transform: 'translateY(20px)', transitionTimingFunction: 'ease-in-out' },\n          },\n          scale: {\n            in: { opacity: 1, transform: 'scale(1)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'scale(0.8)', transitionTimingFunction: 'ease-out' },\n          },\n          rotate: {\n            in: { opacity: 1, transform: 'rotate(0deg) scale(1)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'rotate(90deg) scale(0.9)', transitionTimingFunction: 'ease-out' },\n          },\n          flip: {\n            in: { opacity: 1, transform: 'rotateY(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'rotateY(180deg)', transitionTimingFunction: 'ease-out' },\n          },\n          zoom: {\n            in: { opacity: 1, transform: 'scale(1.2)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'scale(0.8)', transitionTimingFunction: 'ease-out' },\n          },\n          bounce: {\n            in: { opacity: 1, transform: 'translateY(0)', animation: 'bounce 1s cubic-bezier(0.68, -0.55, 0.27, 1.55)' },\n            out: { opacity: 0, transform: 'translateY(-20px)', animation: 'bounceOut 1s ease-out' },\n          },\n          blur: {\n            in: { opacity: 1, filter: 'blur(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, filter: 'blur(5px)', transitionTimingFunction: 'ease-out' },\n          },\n          skew: {\n            in: { opacity: 1, transform: 'skew(0deg)', transitionTimingFunction: 'ease-in-out' },\n            out: { opacity: 0, transform: 'skew(10deg)', transitionTimingFunction: 'ease-in-out' },\n          },\n          slideInLeft: {\n            in: { opacity: 1, transform: 'translateX(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'translateX(-100%)', transitionTimingFunction: 'ease-out' },\n          },\n          slideInRight: {\n            in: { opacity: 1, transform: 'translateX(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'translateX(100%)', transitionTimingFunction: 'ease-out' },\n          },\n          fadeInUp: {\n            in: { opacity: 1, transform: 'translateY(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'translateY(10px)', transitionTimingFunction: 'ease-out' },\n          },\n          fadeInDown: {\n            in: { opacity: 1, transform: 'translateY(0)', transitionTimingFunction: 'ease-in' },\n            out: { opacity: 0, transform: 'translateY(-10px)', transitionTimingFunction: 'ease-out' },\n          },\n          bounceIn: {\n            in: { opacity: 1, transform: 'scale(1.05)', transitionTimingFunction: 'cubic-bezier(0.68, -0.55, 0.27, 1.55)' },\n            out: { opacity: 0, transform: 'scale(0.9)', transitionTimingFunction: 'ease-out' },\n          },\n        };\n      }\n      \n    applyShowAnimation(item, animationType = 'fade') {\n      const duration = this.options.get('animationDuration') || '300ms';\n      const animation = this.animations[animationType]?.in || this.animations.fade.in;\n      \n      item.style.display = 'block';\n      requestAnimationFrame(() => {\n        Object.assign(item.style, animation, {\n          transition: `opacity ${duration} ${animation.transitionTimingFunction}, transform ${duration} ${animation.transitionTimingFunction}`,\n        });\n      });\n    }\n  \n    applyHideAnimation(item, animationType = 'fade') {\n      const duration = this.options.get('animationDuration') || '300ms';\n      const animation = this.animations[animationType]?.out || this.animations.fade.out;\n      \n      Object.assign(item.style, animation, {\n        transition: `opacity ${duration} ${animation.transitionTimingFunction}, transform ${duration} ${animation.transitionTimingFunction}`,\n      });\n\n      const handleTransitionEnd = () => {\n        item.style.display = 'none';\n        item.removeEventListener('transitionend', handleTransitionEnd);\n      };\n      item.addEventListener('transitionend', handleTransitionEnd);\n    }\n\n    setAnimation(animationType) {\n      this.afs.options.set('animationType', animationType);\n    }\n}","/**\n * @fileoverview Filter functionality for AFS\n * @version 1.0.0\n */\n\nimport { Animation } from '../styles/Animation.js';\n\nexport class Filter {\n  /**\n   * @param {import('../AFS').AFS} afs - Main AFS instance\n   */\n  constructor(afs) {\n    this.afs = afs;\n    this.animation = new Animation(afs);\n    this.filterButtons = new Map();\n    this.activeFilters = new Set([\"*\"]);\n    this.currentFilters = new Set([\"*\"]);\n    this.filterGroups = new Map();\n    this.sortOrders = new Map();\n    this.setupFilters();\n  }\n\n  /**\n   * Setup filters\n   * @private\n   */\n  setupFilters() {\n    this.afs.logger.debug(\"Setting up filters\");\n    const filterSelector = this.afs.options.get(\"filterButtonSelector\");\n    if (!filterSelector) return;\n\n    // Initialize filter buttons\n    document.querySelectorAll(filterSelector).forEach((button) => {\n      const filterValue = button.dataset.filter;\n      if (!filterValue) {\n        this.afs.logger.warn(\n          \"Filter button missing data-filter attribute:\",\n          button,\n        );\n        return;\n      }\n\n      this.filterButtons.set(button, filterValue);\n      this.bindFilterEvent(button);\n    });\n\n    this.afs.logger.debug(\"Filters initialized\");\n  }\n\n  /**\n   * Set filter logic mode\n   * @public\n   * @param {string|boolean} logic - 'AND'/'OR' or true/false (true = AND, false = OR)\n   */\n  setLogic(logic) {\n    if (typeof logic === \"boolean\") {\n      // Handle boolean input (true = AND, false = OR)\n      this.afs.options.set(\"filterMode\", logic ? \"AND\" : \"OR\");\n    } else {\n      const mode = logic.toUpperCase();\n      if ([\"OR\", \"AND\"].includes(mode)) {\n        this.afs.options.set(\"filterMode\", mode);\n      } else {\n        this.afs.logger.warn(`Invalid filter mode: ${logic}`);\n        return;\n      }\n    }\n\n    this.afs.logger.debug(\n      `Filter logic set to: ${this.afs.options.get(\"filterMode\")}`,\n    );\n    this.applyFilters();\n  }\n\n  /**\n   * Clear all filters\n   * @public\n   */\n  clearAllFilters() {\n    this.afs.logger.debug(\"Clearing all filters\");\n\n    // Reset filters\n    this.activeFilters.clear();\n    this.activeFilters.add(\"*\");\n\n    // Reset filter buttons\n    this.filterButtons.forEach((_, button) => {\n      button.classList.remove(this.afs.options.get(\"activeClass\"));\n    });\n\n    // Reset filter groups\n    this.filterGroups.clear();\n\n    // Find and activate \"all\" button if exists\n    const allButton = this.findAllButton();\n    if (allButton) {\n      allButton.classList.add(this.afs.options.get(\"activeClass\"));\n    }\n\n    // Clear sorting\n    this.sortOrders.clear();\n\n    // Apply changes and update UI\n    this.applyFilters();\n    this.afs.urlManager.updateURL();\n    this.afs.emit(\"filtersCleared\");\n  }\n\n  /**\n   * Bind filter event to button\n   * @private\n   * @param {HTMLElement} button - Filter button\n   */\n  bindFilterEvent(button) {\n    this.afs.logger.debug(\"Binding filter event to button:\", button);\n\n    button.addEventListener(\"click\", () => {\n      const filterValue = this.filterButtons.get(button);\n\n      if (!filterValue) return;\n\n      if (filterValue === \"*\") {\n        this.resetFilters();\n      } else {\n        this.toggleFilter(filterValue, button);\n      }\n\n      // Update the URL after filter change\n      this.afs.urlManager.updateURL();\n    });\n  }\n\n  /**\n   * Reset filters to default state\n   * @public\n   */\n  resetFilters() {\n    this.afs.logger.debug(\"Resetting filters\");\n  \n    // Clear existing filters\n    this.activeFilters.clear();\n    \n    // Reset button states\n    this.filterButtons.forEach((_, button) => {\n      button.classList.remove(this.afs.options.get(\"activeClass\"));\n    });\n  \n    // Add \"*\" filter and activate \"all\" button\n    this.activeFilters.add(\"*\");\n    const allButton = this.findAllButton();\n    if (allButton) {\n      allButton.classList.add(this.afs.options.get(\"activeClass\"));\n    }\n  \n    // Clear filter groups\n    this.filterGroups.clear();\n  \n    // Force all items to be visible first\n    const visibleItems = new Set(this.afs.items);\n    this.afs.state.setState(\"items.visible\", visibleItems);\n  \n    // Show all items with animation\n    this.afs.items.forEach(item => {\n      item.classList.remove(this.afs.options.get('hiddenClass'));\n      requestAnimationFrame(() => {\n        this.animation.applyShowAnimation(item, this.afs.options.get(\"animationType\"));\n      });\n    });\n  \n    // Update URL after reset\n    this.afs.urlManager.updateURL();\n  }\n\n  /**\n   * Find \"all\" filter button\n   * @private\n   * @returns {HTMLElement|null} All button\n   */\n  findAllButton() {\n    for (const [button, value] of this.filterButtons.entries()) {\n      if (value === \"*\") return button;\n    }\n\n    return null;\n  }\n\n  handleFilterClick(button) {\n    const filterValue = button.dataset.filter;\n    this.afs.logger.debug(\"Filter clicked:\", filterValue);\n\n    if (filterValue === \"*\") {\n      this.resetFilters();\n    } else {\n      this.toggleFilter(filterValue, button);\n    }\n\n    this.filter();\n\n    // Call updateURL to reflect the new filter state in the URL\n    this.updateURL();\n  }\n\n  /**\n   * Toggle filter state\n   * @private\n   * @param {string} filterValue - Filter value\n   * @param {HTMLElement} button - Filter button\n   */\n  toggleFilter(filterValue, button) {\n    // Remove \"all\" filter\n    this.activeFilters.delete(\"*\");\n    const allButton = this.findAllButton();\n    if (allButton) {\n      allButton.classList.remove(this.afs.options.get(\"activeClass\"));\n    }\n\n    // Toggle filter\n    if (button.classList.contains(this.afs.options.get(\"activeClass\"))) {\n      button.classList.remove(this.afs.options.get(\"activeClass\"));\n      this.activeFilters.delete(filterValue);\n\n      // Reset to \"all\" if no filters active\n      if (this.activeFilters.size === 0) {\n          this.resetFilters();\n          return;\n      }\n  } else {\n      button.classList.add(this.afs.options.get(\"activeClass\"));\n      this.activeFilters.add(filterValue);\n  }\n\n    this.applyFilters();\n\n    // update counter\n    this.afs.updateCounter();\n\n    // Emit event\n    this.afs.emit(\"filterToggled\", {\n      filter: filterValue,\n      activeFilters: Array.from(this.activeFilters),\n    });\n\n    this.afs.logger.debug(\"Filter toggled:\", filterValue);\n  }\n\n /**\n * Apply current filters\n * @public\n */\n applyFilters() {\n  // Log active filters\n  const activeFilters = Array.from(this.activeFilters);\n  this.afs.logger.debug(\"Active filters:\", activeFilters);\n  this.afs.logger.debug(\"Applying filters\");\n\n  const previouslyVisible = new Set(this.afs.state.getState().items.visible);\n  const visibleItems = new Set();\n\n  // First pass: determine which items should be visible\n  this.afs.items.forEach(item => {\n    if (this.activeFilters.has(\"*\") || this.itemMatchesFilters(item)) {\n      visibleItems.add(item);\n    }\n  });\n\n  // Update state with determined visible items\n  this.afs.state.setState(\"items.visible\", visibleItems);\n\n  // Second pass: apply animations based on visibility changes\n  this.afs.items.forEach(item => {\n    if (visibleItems.has(item)) {\n      // Remove hidden class first\n      item.classList.remove(this.afs.options.get('hiddenClass'));\n      // Then apply show animation in next frame\n      requestAnimationFrame(() => {\n        this.animation.applyShowAnimation(item, this.afs.options.get(\"animationType\"));\n      });\n    } else {\n      // Apply hide animation\n      requestAnimationFrame(() => {\n        this.animation.applyHideAnimation(item, this.afs.options.get(\"animationType\"));\n      });\n    }\n  });\n\n  // Emit events and update UI\n  this.emitFilterEvents(previouslyVisible, visibleItems);\n\n  // Schedule UI updates\n  requestAnimationFrame(() => {\n    // Force reflow to ensure animations play\n    this.afs.container.offsetHeight;\n\n    // Update counter and URL\n    this.afs.updateCounter();\n    this.afs.urlManager.updateURL();\n\n    // Emit final event\n    this.afs.emit(\"filtersApplied\", {\n      activeFilters,\n      visibleItems: visibleItems.size,\n    });\n  });\n}\n\n  /**\n   * Check if item matches current filters\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @returns {boolean} Whether item matches filters\n   */\n  itemMatchesFilters(item) {\n    // Show all items if \"*\" is active\n    if (this.activeFilters.has(\"*\")) {\n      return true;\n    }\n  \n    // Regular filter matching\n    const itemCategories = new Set(item.dataset.categories?.split(\" \") || []);\n  \n    // If using filter groups\n    if (this.filterGroups.size > 0) {\n      return this.itemMatchesFilterGroups(itemCategories);\n    }\n  \n    // Regular filtering\n    return this.afs.options.get(\"filterMode\") === \"OR\"\n      ? this.itemMatchesAnyFilter(itemCategories)\n      : this.itemMatchesAllFilters(itemCategories);\n  }\n\n  /**\n   * Check if item matches any active filter (OR mode)\n   * @private\n   * @param {Set} itemCategories - Item's categories\n   * @returns {boolean} Whether item matches any filter\n   */\n  itemMatchesAnyFilter(itemCategories) {\n    return Array.from(this.activeFilters).some((filter) => {\n      if (filter === \"*\") return true;\n      return itemCategories.has(filter);\n    });\n  }\n\n  /**\n   * Check if item matches all active filters (AND mode)\n   * @private\n   * @param {Set} itemCategories - Item's categories\n   * @returns {boolean} Whether item matches all filters\n   */\n  itemMatchesAllFilters(itemCategories) {\n    return Array.from(this.activeFilters).every((filter) => {\n      if (filter === \"*\") return true;\n      return itemCategories.has(filter);\n    });\n  }\n\n  /**\n   * Check if item matches filter groups\n   * @private\n   * @param {Set} itemCategories - Item's categories\n   * @returns {boolean} Whether item matches groups\n   */\n  itemMatchesFilterGroups(itemCategories) {\n    const groupMatches = Array.from(this.filterGroups.values()).map((group) => {\n      if (group.filters.size === 0) return true;\n\n      return group.operator === \"OR\"\n        ? Array.from(group.filters).some((filter) => itemCategories.has(filter))\n        : Array.from(group.filters).every((filter) =>\n            itemCategories.has(filter),\n          );\n    });\n\n    return this.afs.options.get(\"groupMode\") === \"OR\"\n      ? groupMatches.some((matches) => matches)\n      : groupMatches.every((matches) => matches);\n  }\n\n  /**\n   * Emit filter-related events\n   * @private\n   * @param {Set} previouslyVisible - Previously visible items\n   * @param {Set} nowVisible - Currently visible items\n   */\n  emitFilterEvents(previouslyVisible, nowVisible) {\n    // Determine added and removed items\n    const added = new Set(\n      [...nowVisible].filter((item) => !previouslyVisible.has(item)),\n    );\n    const removed = new Set(\n      [...previouslyVisible].filter((item) => !nowVisible.has(item)),\n    );\n\n    // Emit filter event\n    this.afs.emit(\"filter\", {\n      activeFilters: Array.from(this.activeFilters),\n      visibleItems: nowVisible.size,\n      added: added.size,\n      removed: removed.size,\n    });\n\n    // Emit specific events for added/removed items\n    if (added.size > 0) {\n      this.afs.emit(\"itemsShown\", { items: added });\n    }\n    if (removed.size > 0) {\n      this.afs.emit(\"itemsHidden\", { items: removed });\n    }\n  }\n\n  /**\n   * Add or update a filter group\n   * @public\n   * @param {string} groupId - Group identifier\n   * @param {string[]} filters - Array of filter values\n   * @param {string} [operator='OR'] - Operator within group\n   */\n  addFilterGroup(groupId, filters, operator = \"OR\") {\n    this.afs.logger.debug(`Adding filter group: ${groupId}`);\n\n    if (!Array.isArray(filters)) {\n      this.afs.logger.error(\"Filters must be an array\");\n      return;\n    }\n\n    const validOperator = operator.toUpperCase();\n    if (![\"AND\", \"OR\"].includes(validOperator)) {\n      this.afs.logger.warn(`Invalid operator: ${operator}, defaulting to OR`);\n      operator = \"OR\";\n    }\n\n    this.filterGroups.set(groupId, {\n      filters: new Set(filters),\n      operator: validOperator,\n    });\n\n    this.applyFilters();\n  }\n\n  /**\n   * Remove a filter group\n   * @public\n   * @param {string} groupId - Group identifier\n   */\n  removeFilterGroup(groupId) {\n    if (this.filterGroups.delete(groupId)) {\n      this.afs.logger.debug(`Removed filter group: ${groupId}`);\n\n      if (this.filterGroups.size === 0) {\n        this.resetFilters();\n      } else {\n        this.applyFilters();\n      }\n    }\n  }\n\n  /**\n   * Set filter group mode\n   * @public\n   * @param {string} mode - Mode for combining groups\n   */\n  setGroupMode(mode) {\n    const validMode = mode.toUpperCase();\n    if ([\"AND\", \"OR\"].includes(validMode)) {\n      this.afs.options.set(\"groupMode\", validMode);\n      this.afs.logger.debug(`Set group mode to: ${validMode}`);\n      this.applyFilters();\n    } else {\n      this.afs.logger.warn(`Invalid group mode: ${mode}`);\n    }\n  }\n\n  /**\n   * Add filter manually\n   * @public\n   * @param {string} filter - Filter value\n   */\n  addFilter(filter) {\n    this.afs.logger.debug(`Adding filter: ${filter}`);\n\n    if (filter === \"*\") {\n      this.resetFilters();\n      return;\n    }\n\n    this.activeFilters.delete(\"*\");\n    this.activeFilters.add(filter);\n\n    // Update button states\n    this.filterButtons.forEach((value, button) => {\n      if (value === filter) {\n        button.classList.add(this.afs.options.get(\"activeClass\"));\n      } else if (value === \"*\") {\n        button.classList.remove(this.afs.options.get(\"activeClass\"));\n      }\n    });\n\n    this.applyFilters();\n  }\n\n  /**\n   * Remove filter manually\n   * @public\n   * @param {string} filter - Filter value\n   */\n  removeFilter(filter) {\n    this.afs.logger.debug(`Removing filter: ${filter}`);\n\n    this.activeFilters.delete(filter);\n\n    // Update button states\n    this.filterButtons.forEach((value, button) => {\n      if (value === filter) {\n        button.classList.remove(this.afs.options.get(\"activeClass\"));\n      }\n    });\n\n    // Reset to all if no filters active\n    if (this.activeFilters.size === 0) {\n      this.resetFilters();\n    } else {\n      this.applyFilters();\n    }\n  }\n\n  /**\n   * Set filter mode\n   * @public\n   * @param {string} mode - Filter mode ('AND' or 'OR')\n   */\n  setFilterMode(mode) {\n    this.afs.logger.debug(`Setting filter mode to: ${mode}`);\n\n    const validMode = mode.toUpperCase();\n    if ([\"AND\", \"OR\"].includes(validMode)) {\n      this.afs.options.set(\"filterMode\", validMode);\n      this.afs.logger.debug(`Set filter mode to: ${validMode}`);\n      this.applyFilters();\n    } else {\n      this.afs.logger.warn(`Invalid filter mode: ${mode}`);\n    }\n  }\n\n  /**\n   * Get active filters\n   * @public\n   * @returns {Set} Active filters\n   */\n  getActiveFilters() {\n    return new Set(this.activeFilters);\n  }\n\n  /**\n   * Get filter groups\n   * @public\n   * @returns {Map} Filter groups\n   */\n  getFilterGroups() {\n    return new Map(this.filterGroups);\n  }\n\n  /**\n   * Add filter button dynamically\n   * @public\n   * @param {HTMLElement} button - Button element\n   * @param {string} filter - Filter value\n   */\n  addFilterButton(button, filter) {\n    if (!filter) {\n      this.afs.logger.warn(\"Filter value required for new filter button\");\n      return;\n    }\n\n    this.filterButtons.set(button, filter);\n    this.bindFilterEvent(button);\n    this.afs.logger.debug(`Added filter button for: ${filter}`);\n  }\n\n  /**\n   * Remove filter button\n   * @public\n   * @param {HTMLElement} button - Button to remove\n   */\n  removeFilter(filter) {\n    this.afs.logger.debug(`Removing filter: ${filter}`);\n\n    this.activeFilters.delete(filter);\n\n    // Update button states\n    this.filterButtons.forEach((value, button) => {\n      if (value === filter) {\n        button.classList.remove(this.afs.options.get(\"activeClass\"));\n      }\n    });\n\n    // Reset to all if no filters active\n    if (this.activeFilters.size === 0) {\n      this.resetFilters();\n    } else {\n      this.applyFilters();\n    }\n  }\n\n  /**\n   * Sort items with automatic order detection\n   * @public\n   * @param {string} key - The data attribute key to sort by\n   */\n  sortWithOrder(key) {\n    this.afs.logger.debug(`Sorting by ${key}`);\n\n    try {\n      const items = Array.from(this.afs.items);\n\n      // Toggle sort order for the key\n      const currentOrder = this.sortOrders.get(key) || \"asc\";\n      const newOrder = currentOrder === \"asc\" ? \"desc\" : \"asc\";\n      this.sortOrders.set(key, newOrder);\n\n      // Determine sort type from first item\n      const sortType = this.determineSortType(items[0], key);\n\n      // Sort items\n      items.sort((a, b) => {\n        const valueA = this.getSortValue(a, key, sortType);\n        const valueB = this.getSortValue(b, key, sortType);\n\n        return this.compareValues(valueA, valueB, newOrder);\n      });\n\n      // Reorder DOM elements\n      this.reorderItems(items);\n\n      // Emit event\n      this.afs.emit(\"sort\", { key, order: newOrder });\n\n      this.afs.logger.info(`Sorted items by ${key} in ${newOrder} order`);\n\n      return newOrder; // Return the new order for UI updates\n    } catch (error) {\n      this.afs.logger.error(\"Sort error:\", error);\n      return null;\n    }\n  }\n\n  /**\n   * Shuffle items randomly\n   * @public\n   */\n  shuffle() {\n    this.afs.logger.debug(\"Shuffling items\");\n\n    try {\n      const items = Array.from(this.afs.items);\n\n      // Fisher-Yates shuffle algorithm\n      for (let i = items.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [items[i], items[j]] = [items[j], items[i]];\n      }\n\n      // Use the existing reorderItems method to update the DOM\n      this.reorderItems(items);\n\n      // Clear any existing sort orders as we've shuffled\n      this.sortOrders.clear();\n\n      this.afs.emit(\"shuffled\", {\n        itemCount: items.length,\n      });\n\n      this.afs.logger.debug(\"Items shuffled successfully\");\n    } catch (error) {\n      this.afs.logger.error(\"Shuffle error:\", error);\n    }\n  }\n\n  /**\n   * Determine sort type from item value\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @param {string} key - Sort key\n   * @returns {string} Sort type ('number', 'date', or 'string')\n   */\n  determineSortType(item, key) {\n    this.afs.logger.debug(`Determining sort type for ${key}`);\n\n    const value = item.dataset[key];\n\n    if (!value) return \"string\";\n    if (!isNaN(value)) return \"number\";\n    if (/^\\d{4}-\\d{2}-\\d{2}/.test(value)) return \"date\";\n\n    return \"string\";\n  }\n\n  /**\n   * Get sort value from item\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @param {string} key - Sort key\n   * @param {string} type - Sort type\n   * @returns {any} Parsed value for sorting\n   */\n  getSortValue(item, key, type) {\n    const value = item.dataset[key];\n\n    switch (type) {\n      case \"number\":\n        return parseFloat(value) || 0;\n      case \"date\":\n        return new Date(value).getTime() || 0;\n      default:\n        return (value || \"\").toLowerCase();\n    }\n  }\n\n  /**\n   * Compare two values for sorting\n   * @private\n   * @param {any} a - First value\n   * @param {any} b - Second value\n   * @param {string} order - Sort order ('asc' or 'desc')\n   * @returns {number} Comparison result\n   */\n  compareValues(a, b, order) {\n    // Handle null/undefined values\n    if (a === null || a === undefined) return order === \"asc\" ? 1 : -1;\n    if (b === null || b === undefined) return order === \"asc\" ? -1 : 1;\n\n    // Compare values\n    const comparison = a < b ? -1 : a > b ? 1 : 0;\n    return order === \"asc\" ? comparison : -comparison;\n  }\n\n  /**\n   * Reorder DOM elements\n   * @private\n   * @param {HTMLElement[]} items - Sorted items\n   */\n  reorderItems(items) {\n    const fragment = document.createDocumentFragment();\n    items.forEach((item) => fragment.appendChild(item));\n    this.afs.container.appendChild(fragment);\n  }\n\n  /**\n   * Get current sort order for key\n   * @public\n   * @param {string} key - Sort key\n   * @returns {string} Current sort order ('asc' or 'desc')\n   */\n  getCurrentSortOrder(key) {\n    return this.sortOrders.get(key) || \"asc\";\n  }\n\n  /**\n   * Clear all sort orders\n   * @public\n   */\n  clearSortOrders() {\n    this.afs.logger.debug(\"Clearing all sort orders\");\n\n    this.sortOrders.clear();\n    this.afs.emit(\"sortCleared\");\n  }\n\n  /**\n   * Clear all filters, url and search\n   * @public\n   */\n  clearAllFilters() {\n    this.afs.logger.debug(\"Clearing all filters and search\");\n\n    // Reset filters\n    this.activeFilters.clear();\n    this.activeFilters.add(\"*\");\n\n    // Update filter buttons\n    this.filterButtons.forEach((_, button) => {\n      button.classList.remove(this.afs.options.get(\"activeClass\"));\n    });\n\n    // Find and activate \"all\" button if exists\n    const allButton = this.findAllButton();\n    if (allButton) {\n      allButton.classList.add(this.afs.options.get(\"activeClass\"));\n    }\n\n    // Clear checkboxes\n    const checkboxes = document.querySelectorAll('input[type=\"checkbox\"]');\n    checkboxes.forEach((checkbox) => {\n      if (checkbox.classList.contains(this.afs.options.get(\"activeClass\"))) {\n        checkbox.checked = false;\n        checkbox.classList.remove(this.afs.options.get(\"activeClass\"));\n      }\n    });\n\n    // Clear search\n    if (this.afs.search) {\n      this.afs.search.setValue(\"\");\n    }\n\n    // Clear filter groups and sort orders\n    this.filterGroups.clear();\n    this.sortOrders.clear();\n\n    // Apply changes\n    this.applyFilters();\n\n    if (this.afs.urlManager) {\n      this.afs.urlManager.updateURL();\n    }\n\n    // Emit event\n    this.afs.emit(\"filtersCleared\");\n\n    this.afs.logger.info(\"All filters cleared\");\n  }\n\n  /**\n   * Refresh the view\n   * @public\n   */\n  refresh() {\n    this.afs.logger.debug(\"Refreshing view\");\n\n    this.applyFilters();\n    this.afs.updateCounter();\n  }\n\n  removeFilterButton(button) {\n    this.filterButtons.delete(button);\n    button.removeEventListener(\"click\", this.handleFilterClick);\n  }\n\n  /**\n   * Destroy instance\n   * @public\n   */\n  destroy() {\n    this.filterButtons.forEach((_, button) => {\n      this.removeFilterButton(button);\n    });\n    this.filterButtons.clear();\n    this.activeFilters.clear();\n    this.filterGroups.clear();\n    this.afs.logger.debug(\"Filter functionality destroyed\");\n  }\n}\n","/**\n * @fileoverview Utility functions for AFS\n * @version 1.0.0\n */\n\n/**\n * Debounce function\n * @param {Function} func - Function to debounce\n * @param {number} wait - Delay in milliseconds\n * @param {boolean} [immediate=false] - Execute immediately\n * @returns {Function} Debounced function\n */\nexport function debounce(func, wait, immediate = false) {\n    let timeout;\n    return function executedFunction(...args) {\n      const context = this;\n      const later = () => {\n        timeout = null;\n        if (!immediate) func.apply(context, args);\n      };\n      const callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) func.apply(context, args);\n    };\n  }\n  \n  /**\n   * Throttle function\n   * @param {Function} func - Function to throttle\n   * @param {number} limit - Time limit in milliseconds\n   * @returns {Function} Throttled function\n   */\n  export function throttle(func, limit) {\n    let inThrottle;\n    return function executedFunction(...args) {\n      const context = this;\n      if (!inThrottle) {\n        func.apply(context, args);\n        inThrottle = true;\n        setTimeout(() => (inThrottle = false), limit);\n      }\n    };\n  }\n  \n  /**\n   * Parse date string according to format\n   * @param {string} dateStr - Date string to parse\n   * @param {string} format - Date format\n   * @returns {Date|null} Parsed date object or null if invalid\n   */\n  export function parseDate(dateStr, format) {\n    const formats = {\n      'YYYY-MM-DD': /^\\d{4}-\\d{2}-\\d{2}$/,\n      'DD-MM-YYYY': /^\\d{2}-\\d{2}-\\d{4}$/,\n      'MM/DD/YYYY': /^\\d{2}\\/\\d{2}\\/\\d{4}$/\n    };\n  \n    try {\n      if (formats[format]?.test(dateStr)) {\n        const parts = dateStr.split(/[-\\/]/);\n        switch (format) {\n          case 'YYYY-MM-DD':\n            return new Date(parts[0], parts[1] - 1, parts[2]);\n          case 'DD-MM-YYYY':\n            return new Date(parts[2], parts[1] - 1, parts[0]);\n          case 'MM/DD/YYYY':\n            return new Date(parts[2], parts[0] - 1, parts[1]);\n        }\n      }\n      return new Date(dateStr);\n    } catch {\n      return null;\n    }\n  }\n  \n  /**\n   * Get element's computed style value\n   * @param {HTMLElement} element - Target element\n   * @param {string} property - CSS property\n   * @returns {string} Computed style value\n   */\n  export function getStyle(element, property) {\n    return window.getComputedStyle(element).getPropertyValue(property);\n  }\n  \n  /**\n   * Check if element matches a selector\n   * @param {HTMLElement} element - Element to check\n   * @param {string} selector - CSS selector\n   * @returns {boolean} Whether element matches selector\n   */\n  export function matches(element, selector) {\n    return (\n      element.matches ||\n      element.matchesSelector ||\n      element.msMatchesSelector ||\n      element.mozMatchesSelector ||\n      element.webkitMatchesSelector ||\n      element.oMatchesSelector\n    ).call(element, selector);\n  }\n  \n  /**\n   * Deep clone an object\n   * @param {Object} obj - Object to clone\n   * @returns {Object} Cloned object\n   */\n  export function deepClone(obj) {\n    if (obj === null || typeof obj !== 'object') return obj;\n    if (obj instanceof Date) return new Date(obj);\n    if (obj instanceof Array) return obj.map(item => deepClone(item));\n    if (obj instanceof Set) return new Set([...obj].map(item => deepClone(item)));\n    if (obj instanceof Map) return new Map([...obj].map(([k, v]) => [deepClone(k), deepClone(v)]));\n    \n    return Object.fromEntries(\n      Object.entries(obj).map(([key, value]) => [key, deepClone(value)])\n    );\n  }\n  \n  /**\n   * Generate unique ID\n   * @param {string} [prefix=''] - ID prefix\n   * @returns {string} Unique ID\n   */\n  export function uniqueId(prefix = '') {\n    return `${prefix}${Math.random().toString(36).substr(2, 9)}`;\n  }\n  \n  /**\n   * Check if value is plain object\n   * @param {any} value - Value to check\n   * @returns {boolean} Whether value is plain object\n   */\n  export function isPlainObject(value) {\n    return Object.prototype.toString.call(value) === '[object Object]';\n  }","/**\n * @fileoverview Search functionality for AFS\n * @version 1.0.0\n */\n\nimport { debounce } from '../utils';\n\nexport class Search {\n  /**\n   * @param {import('../AFS').AFS} afs - Main AFS instance\n   */\n  constructor(afs) {\n    this.afs = afs;\n    this.searchInput = null;\n    this.searchKeys = ['title']; // Default search keys\n    this.minSearchLength = 2;\n    this.highlightClass = 'afs-highlight';\n    this.setupSearch();\n  }\n\n  /**\n   * Setup search functionality\n   * @private\n   */\n  setupSearch() {\n    const searchSelector = this.afs.options.get('searchInputSelector');\n    if (!searchSelector) return;\n\n    this.searchInput = document.querySelector(searchSelector);\n    if (!this.searchInput) {\n      this.afs.logger.warn(`Search input not found: ${searchSelector}`);\n      return;\n    }\n\n    // Configure search\n    this.searchKeys = this.afs.options.get('searchKeys') || this.searchKeys;\n    this.minSearchLength = this.afs.options.get('minSearchLength') || this.minSearchLength;\n\n    // Bind events\n    this.bindSearchEvents();\n    this.afs.logger.debug('Search functionality initialized');\n  }\n\n  /**\n   * Bind search events\n   * @private\n   */\n  bindSearchEvents() {\n    if (!this.searchInput) return;\n\n    // Create debounced search function\n    const debouncedSearch = debounce((e) => {\n      this.search(e.target.value);\n    }, this.afs.options.get('debounceTime') || 300);\n\n    // Bind input event\n    this.searchInput.addEventListener('input', debouncedSearch);\n\n    // Bind clear event\n    this.searchInput.addEventListener('search', (e) => {\n      if (!e.target.value) {\n        this.clearSearch();\n      }\n    });\n\n    // Handle Enter key\n    this.searchInput.addEventListener('keypress', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        this.search(e.target.value);\n      }\n    });\n  }\n\n  /**\n   * Perform search\n   * @public\n   * @param {string} query - Search query\n   */\n  search(query) {\n    this.afs.logger.debug('Performing search:', query);\n    const normalizedQuery = this.normalizeQuery(query);\n\n    // Update state\n    this.afs.state.setState('search.query', normalizedQuery);\n    let matches = 0;\n\n    // Special case for empty query\n    if (!normalizedQuery) {\n      this.clearSearch();\n      return;\n    }\n\n    // Skip if query is too short\n    if (normalizedQuery.length < this.minSearchLength) {\n      this.afs.logger.debug('Search query too short');\n      return;\n    }\n\n    try {\n      // Create search regex\n      const regex = this.createSearchRegex(normalizedQuery);\n\n      // Search through items\n      this.afs.items.forEach(item => {\n        const searchText = this.getItemSearchText(item);\n        const matchesSearch = regex.test(searchText);\n\n        if (matchesSearch) {\n          this.afs.showItem(item);\n          this.highlightMatches(item, regex);\n          matches++;\n        } else {\n          this.afs.hideItem(item);\n          this.removeHighlights(item);\n        }\n      });\n\n      // Update URL and emit event\n      this.afs.urlManager.updateURL();\n      this.afs.emit('search', {\n        query: normalizedQuery,\n        matches,\n        total: this.afs.items.length\n      });\n\n      this.afs.logger.info(`Search complete. Found ${matches} matches`);\n    } catch (error) {\n      this.afs.logger.error('Search error:', error);\n    }\n\n    // Update counter after animation\n    setTimeout(() => {\n      this.afs.updateCounter();\n    }, this.afs.options.get('animationDuration'));\n  }\n\n  /**\n   * Normalize search query\n   * @private\n   * @param {string} query - Raw search query\n   * @returns {string} Normalized query\n   */\n  normalizeQuery(query) {\n    return query\n      .toLowerCase()\n      .trim()\n      .replace(/\\s+/g, ' ');\n  }\n\n  /**\n   * Create search regex\n   * @private\n   * @param {string} query - Normalized search query\n   * @returns {RegExp} Search regex\n   */\n  createSearchRegex(query) {\n    // Escape special regex characters\n    const escapedQuery = query.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n    \n    // Split into words for whole word matching\n    const words = escapedQuery.split(' ').filter(Boolean);\n    \n    // Create regex pattern\n    const pattern = words\n      .map(word => `(?=.*\\\\b${word})`)\n      .join('');\n    \n    return new RegExp(pattern, 'i');\n  }\n\n  /**\n   * Get searchable text from item\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @returns {string} Searchable text\n   */\n  getItemSearchText(item) {\n    return this.searchKeys\n      .map(key => item.dataset[key] || '')\n      .join(' ')\n      .toLowerCase();\n  }\n\n  /**\n   * Highlight search matches\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @param {RegExp} regex - Search regex\n   */\n  highlightMatches(item, regex) {\n    if (!this.afs.options.get('highlightMatches')) return;\n\n    this.searchKeys.forEach(key => {\n      const target = item.querySelector(`[data-search-key=\"${key}\"]`);\n      if (!target) return;\n\n      const text = target.textContent;\n      const words = this.afs.state.getState().search.query.split(' ');\n\n      let highlightedText = text;\n      words.forEach(word => {\n        if (!word) return;\n        const wordRegex = new RegExp(`(${word})`, 'gi');\n        highlightedText = highlightedText.replace(\n          wordRegex,\n          `<span class=\"${this.highlightClass}\">$1</span>`\n        );\n      });\n\n      target.innerHTML = highlightedText;\n    });\n  }\n\n  /**\n   * Remove highlights\n   * @private\n   * @param {HTMLElement} item - DOM element\n   */\n  removeHighlights(item) {\n    if (!this.afs.options.get('highlightMatches')) return;\n\n    this.searchKeys.forEach(key => {\n      const target = item.querySelector(`[data-search-key=\"${key}\"]`);\n      if (!target) return;\n\n      const highlights = target.querySelectorAll(`.${this.highlightClass}`);\n      highlights.forEach(highlight => {\n        const text = highlight.textContent;\n        highlight.replaceWith(text);\n      });\n    });\n  }\n\n  /**\n   * Clear search\n   * @public\n   */\n  clearSearch() {\n    this.afs.logger.debug('Clearing search');\n\n    // Clear input\n    if (this.searchInput) {\n      this.searchInput.value = '';\n    }\n\n    // Clear state\n    this.afs.state.setState('search.query', '');\n\n    // Show all items\n    this.afs.items.forEach(item => {\n      this.afs.showItem(item);\n      this.removeHighlights(item);\n    });\n\n    // Update URL and emit event\n    this.afs.urlManager.updateURL();\n    this.afs.emit('searchCleared');\n\n    // Update counter\n    setTimeout(() => {\n      this.afs.updateCounter();\n    }, this.afs.options.get('animationDuration'));\n  }\n\n  /**\n   * Set search value\n   * @public\n   * @param {string} value - Search value\n   */\n  setValue(value) {\n    if (this.searchInput) {\n      this.searchInput.value = value;\n    }\n    this.search(value);\n  }\n\n  /**\n   * Get current search value\n   * @public\n   * @returns {string} Current search value\n   */\n  getValue() {\n    return this.afs.state.getState().search.query;\n  }\n\n  /**\n   * Update search configuration\n   * @public\n   * @param {Object} config - Search configuration\n   */\n  updateConfig({\n    searchKeys,\n    minSearchLength,\n    highlightClass,\n    debounceTime\n  } = {}) {\n    if (searchKeys) this.searchKeys = searchKeys;\n    if (minSearchLength) this.minSearchLength = minSearchLength;\n    if (highlightClass) this.highlightClass = highlightClass;\n    if (debounceTime) {\n      this.bindSearchEvents(); // Rebind with new debounce time\n    }\n  }\n\n  /**\n   * Destroy search functionality\n   * @public\n   */\n  destroy() {\n    if (this.searchInput) {\n      this.searchInput.removeEventListener('input', this.debouncedSearch);\n      this.searchInput.removeEventListener('search', this.handleClear);\n      this.searchInput.removeEventListener('keypress', this.handleEnter);\n    }\n    this.clearSearch();\n  }\n}","/**\n * @fileoverview Sort functionality for AFS\n * @version 1.0.0\n */\n\nexport class Sort {\n  /**\n   * @param {import('../AFS').AFS} afs - Main AFS instance\n   */\n  constructor(afs) {\n    this.afs = afs;\n    this.sortButtons = new Map();\n    this.setupSort();\n  }\n\n  /**\n   * Setup sort functionality\n   * @private\n   */\n  setupSort() {\n    const sortSelector = this.afs.options.get(\"sortButtonSelector\");\n    if (!sortSelector) return;\n\n    // Find and setup sort buttons\n    document.querySelectorAll(sortSelector).forEach((button) => {\n      const key = button.dataset.sortKey;\n      if (!key) {\n        this.afs.logger.warn(\n          \"Sort button missing data-sort-key attribute:\",\n          button,\n        );\n        return;\n      }\n\n      this.sortButtons.set(button, {\n        key,\n        direction: button.dataset.sortDirection || \"asc\",\n      });\n\n      this.bindSortEvent(button);\n    });\n\n    this.afs.logger.debug(\"Sort functionality initialized\");\n  }\n\n  /**\n   * Bind sort event to button\n   * @private\n   * @param {HTMLElement} button - Sort button\n   */\n  bindSortEvent(button) {\n    this.afs.logger.debug(\"Binding sort event to button:\", button);\n\n    button.addEventListener(\"click\", () => {\n      const sortData = this.sortButtons.get(button);\n      if (!sortData) return;\n\n      // Toggle direction\n      sortData.direction = sortData.direction === \"asc\" ? \"desc\" : \"asc\";\n      this.sortButtons.set(button, sortData);\n\n      // Update button state\n      this.updateSortButtonState(button, sortData);\n\n      // Perform sort\n      this.sort(sortData.key, sortData.direction);\n    });\n  }\n\n  /**\n   * Update sort button visual state\n   * @private\n   * @param {HTMLElement} button - Sort button\n   * @param {Object} sortData - Sort data\n   */\n  updateSortButtonState(button, sortData) {\n    // Remove active class from all buttons\n    this.sortButtons.forEach((_, btn) => {\n      btn.classList.remove(this.afs.options.get(\"activeSortClass\"));\n    });\n\n    // Add active class to current button\n    button.classList.add(this.afs.options.get(\"activeSortClass\"));\n\n    // Update direction indicator\n    const indicator = button.querySelector(\".sort-direction\");\n    if (indicator) {\n      indicator.textContent = sortData.direction === \"asc\" ? \"↑\" : \"↓\";\n    }\n  }\n\n  /**\n   * Sort items\n   * @public\n   * @param {string} key - Sort key\n   * @param {string} direction - Sort direction ('asc' or 'desc')\n   */\n  sort(key, direction = \"asc\") {\n    this.afs.logger.debug(`Sorting by ${key} in ${direction} order`);\n\n    try {\n      // Update state\n      this.afs.state.setState(\"sort.current\", { key, direction });\n\n      // Get all items as array\n      const items = Array.from(this.afs.items);\n\n      // Determine sort type\n      const sortType = this.determineSortType(items[0], key);\n\n      // Sort items\n      items.sort((a, b) => {\n        const valueA = this.getSortValue(a, key, sortType);\n        const valueB = this.getSortValue(b, key, sortType);\n\n        return this.compareValues(valueA, valueB, direction);\n      });\n\n      // Reorder DOM elements\n      this.reorderItems(items);\n\n      // Update URL and emit event\n      this.afs.urlManager.updateURL();\n      this.afs.emit(\"sort\", { key, direction });\n\n      this.afs.logger.info(`Sorted items by ${key} ${direction}`);\n    } catch (error) {\n      this.afs.logger.error(\"Sort error:\", error);\n    }\n  }\n\n  /**\n   * Determine sort type from first item\n   * @private\n   * @param {HTMLElement} item - First item\n   * @param {string} key - Sort key\n   * @returns {string} Sort type\n   */\n  determineSortType(item, key) {\n    const value = item.dataset[key];\n\n    if (!value) return \"string\";\n    if (!isNaN(value)) return \"number\";\n    if (/^\\d{4}-\\d{2}-\\d{2}/.test(value)) return \"date\";\n\n    return \"string\";\n  }\n\n  /**\n   * Get sort value from item\n   * @private\n   * @param {HTMLElement} item - DOM element\n   * @param {string} key - Sort key\n   * @param {string} type - Sort type\n   * @returns {any} Sort value\n   */\n  getSortValue(item, key, type) {\n    const value = item.dataset[key];\n\n    switch (type) {\n      case \"number\":\n        return parseFloat(value);\n      case \"date\":\n        return new Date(value).getTime();\n      default:\n        return value.toLowerCase();\n    }\n  }\n\n  /**\n   * Compare two values\n   * @private\n   * @param {any} a - First value\n   * @param {any} b - Second value\n   * @param {string} direction - Sort direction\n   * @returns {number} Comparison result\n   */\n  compareValues(a, b, direction) {\n    const modifier = direction === \"asc\" ? 1 : -1;\n\n    if (a === b) return 0;\n    if (a === undefined || a === null) return 1;\n    if (b === undefined || b === null) return -1;\n\n    return a > b ? modifier : -modifier;\n  }\n\n  /**\n   * Reorder DOM elements\n   * @private\n   * @param {HTMLElement[]} items - Sorted items\n   */\n  reorderItems(items) {\n    const container = this.afs.options.get(\"container\");\n    const fragment = document.createDocumentFragment();\n\n    items.forEach((item) => fragment.appendChild(item));\n    container.appendChild(fragment);\n  }\n  /**\n   * Sort with multiple criteria\n   * @public\n   * @param {Array<{key: string, direction: string}>} criteria - Sort criteria\n   */\n  sortMultiple(criteria) {\n    this.afs.logger.debug(\"Sorting by multiple criteria:\", criteria);\n\n    try {\n      const items = Array.from(this.afs.items);\n\n      items.sort((a, b) => {\n        for (const { key, direction } of criteria) {\n          const type = this.determineSortType(items[0], key);\n          const valueA = this.getSortValue(a, key, type);\n          const valueB = this.getSortValue(b, key, type);\n\n          const comparison = this.compareValues(valueA, valueB, direction);\n          if (comparison !== 0) return comparison;\n        }\n        return 0;\n      });\n\n      this.reorderItems(items);\n\n      // Update state with primary sort\n      if (criteria.length > 0) {\n        this.afs.state.setState(\"sort.current\", criteria[0]);\n      }\n\n      this.afs.urlManager.updateURL();\n      this.afs.emit(\"multiSort\", { criteria });\n    } catch (error) {\n      this.afs.logger.error(\"Multiple sort error:\", error);\n    }\n  }\n\n  /**\n   * Sort with custom comparator\n   * @public\n   * @param {string} key - Sort key\n   * @param {Function} comparator - Custom comparison function\n   */\n  sortWithComparator(key, comparator) {\n    this.afs.logger.debug(`Sorting by ${key} with custom comparator`);\n\n    try {\n      const items = Array.from(this.afs.items);\n\n      items.sort((a, b) => {\n        const valueA = a.dataset[key];\n        const valueB = b.dataset[key];\n        return comparator(valueA, valueB);\n      });\n\n      this.reorderItems(items);\n      this.afs.emit(\"customSort\", { key, comparator });\n    } catch (error) {\n      this.afs.logger.error(\"Custom sort error:\", error);\n    }\n  }\n\n  /**\n   * Shuffle items randomly\n   * @public\n   */\n  shuffle() {\n    this.afs.logger.debug(\"Shuffling items\");\n\n    try {\n      const items = Array.from(this.afs.items);\n\n      // Fisher-Yates shuffle algorithm\n      for (let i = items.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [items[i], items[j]] = [items[j], items[i]];\n      }\n\n      this.reorderItems(items);\n\n      // Clear current sort state\n      this.afs.state.setState(\"sort.current\", null);\n\n      // Update UI\n      this.sortButtons.forEach((_, button) => {\n        button.classList.remove(this.afs.options.get(\"activeSortClass\"));\n        const indicator = button.querySelector(\".sort-direction\");\n        if (indicator) indicator.textContent = \"\";\n      });\n\n      this.afs.urlManager.updateURL();\n      this.afs.emit(\"shuffle\");\n    } catch (error) {\n      this.afs.logger.error(\"Shuffle error:\", error);\n    }\n  }\n\n  /**\n   * Reset sort to default state\n   * @public\n   */\n  reset() {\n    this.afs.logger.debug(\"Resetting sort\");\n\n    // Clear sort state\n    this.afs.state.setState(\"sort.current\", null);\n\n    // Reset UI\n    this.sortButtons.forEach((_, button) => {\n      button.classList.remove(this.afs.options.get(\"activeSortClass\"));\n      const indicator = button.querySelector(\".sort-direction\");\n      if (indicator) indicator.textContent = \"\";\n    });\n\n    // Reset sort data\n    this.sortButtons.forEach((data, button) => {\n      data.direction = \"asc\";\n      this.sortButtons.set(button, data);\n    });\n\n    this.afs.urlManager.updateURL();\n    this.afs.emit(\"sortReset\");\n  }\n\n  /**\n   * Get current sort state\n   * @public\n   * @returns {Object|null} Current sort state\n   */\n  getCurrentSort() {\n    return this.afs.state.getState().sort.current;\n  }\n\n  /**\n   * Add sort button dynamically\n   * @public\n   * @param {HTMLElement} button - Sort button element\n   * @param {string} key - Sort key\n   * @param {string} [direction='asc'] - Initial sort direction\n   */\n  addSortButton(button, key, direction = \"asc\") {\n    if (!key) {\n      this.afs.logger.warn(\"Sort key required for new sort button\");\n      return;\n    }\n\n    this.sortButtons.set(button, { key, direction });\n    this.bindSortEvent(button);\n    this.afs.logger.debug(`Added sort button for ${key}`);\n  }\n\n  /**\n   * Remove sort button\n   * @public\n   * @param {HTMLElement} button - Sort button to remove\n   */\n  removeSortButton(button) {\n    if (this.sortButtons.has(button)) {\n      button.removeEventListener(\"click\", this.bindSortEvent);\n      this.sortButtons.delete(button);\n      this.afs.logger.debug(\"Removed sort button\");\n    }\n  }\n\n  /**\n   * Destroy sort functionality\n   * @public\n   */\n  destroy() {\n    this.sortButtons.forEach((_, button) => {\n      this.removeSortButton(button);\n    });\n    this.sortButtons.clear();\n    this.afs.logger.debug(\"Sort functionality destroyed\");\n  }\n}\n","/**\n * @fileoverview Pagination functionality for AFS\n * @version 1.0.0\n */\n\nexport class Pagination {\n    /**\n     * @param {import('../AFS').AFS} afs - Main AFS instance\n     */\n    constructor(afs) {\n      this.afs = afs;\n      this.container = null;\n      this.options = this.afs.options.get('pagination') || {};\n      this.setupPagination();\n    }\n  \n    /**\n     * Setup pagination\n     * @private\n     */\n    setupPagination() {\n      if (!this.options.enabled) return;\n  \n      this.container = document.createElement('div');\n      this.container.className = this.options.containerClass || 'afs-pagination';\n      \n      // Add pagination container after the items container\n      const itemsContainer = this.afs.options.get('container');\n      itemsContainer.parentNode.insertBefore(this.container, itemsContainer.nextSibling);\n  \n      // Initialize state\n      this.afs.state.setState('pagination', {\n        currentPage: 1,\n        itemsPerPage: this.options.itemsPerPage || 10,\n        totalPages: 0\n      });\n  \n      this.bindEvents();\n      this.update();\n      this.afs.logger.debug('Pagination initialized');\n    }\n  \n    /**\n     * Bind pagination events\n     * @private\n     */\n    bindEvents() {\n      // Listen for AFS filter events\n      this.afs.on('filter', () => this.update());\n      this.afs.on('search', () => this.update());\n      this.afs.on('sort', () => this.update());\n  \n      // Delegate click events for pagination buttons\n      this.container.addEventListener('click', (e) => {\n        const button = e.target.closest('button');\n        if (!button) return;\n  \n        const page = button.dataset.page;\n        if (page) {\n          this.goToPage(parseInt(page));\n        }\n      });\n    }\n  \n    /**\n     * Update pagination\n     * @public\n     */\n    update() {\n      const visibleItems = this.afs.state.getState().items.visible;\n      const itemsPerPage = this.afs.state.getState().pagination.itemsPerPage;\n      const totalPages = Math.ceil(visibleItems.size / itemsPerPage);\n  \n      // Update state\n      this.afs.state.setState('pagination.totalPages', totalPages);\n  \n      // Ensure current page is valid\n      const currentPage = this.afs.state.getState().pagination.currentPage;\n      if (currentPage > totalPages) {\n        this.goToPage(1);\n        return;\n      }\n  \n      this.updateVisibility();\n      this.renderPagination();\n      this.afs.urlManager.updateURL();\n  \n      this.afs.emit('pagination', {\n        currentPage,\n        totalPages,\n        itemsPerPage,\n        visibleItems: visibleItems.size\n      });\n    }\n  \n    /**\n     * Update items visibility based on current page\n     * @private\n     */\n    updateVisibility() {\n      const state = this.afs.state.getState();\n      const { currentPage, itemsPerPage } = state.pagination;\n      const visibleItems = Array.from(state.items.visible);\n  \n      const startIndex = (currentPage - 1) * itemsPerPage;\n      const endIndex = startIndex + itemsPerPage;\n  \n      visibleItems.forEach((item, index) => {\n        if (index >= startIndex && index < endIndex) {\n          this.afs.showItem(item);\n        } else {\n          this.afs.hideItem(item);\n        }\n      });\n    }\n  \n    /**\n     * Render pagination controls\n     * @private\n     */\n    renderPagination() {\n      const state = this.afs.state.getState().pagination;\n      const { currentPage, totalPages } = state;\n  \n      // Clear existing controls\n      this.container.innerHTML = '';\n  \n      // Don't render if only one page\n      if (totalPages <= 1) {\n        this.container.style.display = 'none';\n        return;\n      }\n  \n      this.container.style.display = 'flex';\n      const controls = this.createPaginationControls(currentPage, totalPages);\n      this.container.appendChild(controls);\n    }\n  \n    /**\n     * Create pagination controls\n     * @private\n     * @param {number} currentPage - Current page\n     * @param {number} totalPages - Total pages\n     * @returns {DocumentFragment} Pagination controls\n     */\n    createPaginationControls(currentPage, totalPages) {\n      const fragment = document.createDocumentFragment();\n  \n      // Previous button\n      if (this.options.showPrevNext) {\n        const prevButton = this.createPageButton('‹', currentPage - 1, {\n          disabled: currentPage === 1,\n          class: 'afs-pagination-prev'\n        });\n        fragment.appendChild(prevButton);\n      }\n  \n      // First page\n      fragment.appendChild(this.createPageButton('1', 1, {\n        active: currentPage === 1\n      }));\n  \n      // Calculate page range\n      const range = this.calculatePageRange(currentPage, totalPages);\n  \n      // Add ellipsis and pages\n      if (range.start > 2) {\n        fragment.appendChild(this.createEllipsis());\n      }\n  \n      for (let i = range.start; i <= range.end; i++) {\n        if (i === 1 || i === totalPages) continue;\n        fragment.appendChild(this.createPageButton(i.toString(), i, {\n          active: currentPage === i\n        }));\n      }\n  \n      if (range.end < totalPages - 1) {\n        fragment.appendChild(this.createEllipsis());\n      }\n  \n      // Last page\n      if (totalPages > 1) {\n        fragment.appendChild(this.createPageButton(totalPages.toString(), totalPages, {\n          active: currentPage === totalPages\n        }));\n      }\n  \n      // Next button\n      if (this.options.showPrevNext) {\n        const nextButton = this.createPageButton('›', currentPage + 1, {\n          disabled: currentPage === totalPages,\n          class: 'afs-pagination-next'\n        });\n        fragment.appendChild(nextButton);\n      }\n  \n      return fragment;\n    }\n  \n    /**\n     * Create page button\n     * @private\n     * @param {string} text - Button text\n     * @param {number} page - Page number\n     * @param {Object} options - Button options\n     * @returns {HTMLButtonElement} Page button\n     */\n    createPageButton(text, page, { active = false, disabled = false, class: className = '' } = {}) {\n      const button = document.createElement('button');\n      button.textContent = text;\n      button.dataset.page = page;\n      button.classList.add(this.options.pageButtonClass || 'afs-page-button');\n      \n      if (className) {\n        button.classList.add(className);\n      }\n      \n      if (active) {\n        button.classList.add(this.options.activePageClass || 'afs-page-active');\n      }\n      \n      if (disabled) {\n        button.disabled = true;\n        button.classList.add('afs-page-disabled');\n      }\n  \n      return button;\n    }\n  \n    /**\n     * Create ellipsis element\n     * @private\n     * @returns {HTMLSpanElement} Ellipsis element\n     */\n    createEllipsis() {\n      const span = document.createElement('span');\n      span.textContent = '...';\n      span.classList.add('afs-pagination-ellipsis');\n      return span;\n    }\n  \n    /**\n     * Calculate page range to display\n     * @private\n     * @param {number} currentPage - Current page\n     * @param {number} totalPages - Total pages\n     * @returns {Object} Page range\n     */\n    calculatePageRange(currentPage, totalPages) {\n      const maxButtons = this.options.maxButtons || 7;\n      const sideButtons = Math.floor((maxButtons - 3) / 2); // Subtract first, last, and current\n  \n      let start = Math.max(2, currentPage - sideButtons);\n      let end = Math.min(totalPages - 1, start + maxButtons - 3);\n  \n      if (end - start < maxButtons - 3) {\n        start = Math.max(2, end - (maxButtons - 3));\n      }\n  \n      return { start, end };\n    }\n  \n    /**\n     * Go to specific page\n     * @public\n     * @param {number} page - Target page\n     */\n    goToPage(page) {\n      const state = this.afs.state.getState().pagination;\n      const targetPage = Math.max(1, Math.min(page, state.totalPages));\n  \n      if (targetPage === state.currentPage) return;\n  \n      this.afs.state.setState('pagination.currentPage', targetPage);\n      this.update();\n      \n      // Scroll to top if enabled\n      if (this.options.scrollToTop) {\n        this.scrollToTop();\n      }\n    }\n  \n    /**\n     * Scroll to top of container\n     * @private\n     */\n    scrollToTop() {\n      const container = this.afs.options.get('container');\n      const offset = this.options.scrollOffset || 0;\n      \n      window.scrollTo({\n        top: container.offsetTop - offset,\n        behavior: 'smooth'\n      });\n    }\n  \n    /**\n     * Set items per page\n     * @public\n     * @param {number} count - Items per page\n     */\n    setItemsPerPage(count) {\n      this.afs.state.setState('pagination.itemsPerPage', count);\n      this.afs.state.setState('pagination.currentPage', 1);\n      this.update();\n    }\n  \n    /**\n     * Get current page info\n     * @public\n     * @returns {Object} Page info\n     */\n    getPageInfo() {\n      const state = this.afs.state.getState();\n      const { currentPage, itemsPerPage, totalPages } = state.pagination;\n      const totalItems = state.items.visible.size;\n      \n      const startIndex = (currentPage - 1) * itemsPerPage;\n      const endIndex = Math.min(startIndex + itemsPerPage, totalItems);\n  \n      return {\n        currentPage,\n        itemsPerPage,\n        totalPages,\n        totalItems,\n        startIndex: startIndex + 1,\n        endIndex,\n        hasNextPage: currentPage < totalPages,\n        hasPrevPage: currentPage > 1\n      };\n    }\n  \n    /**\n     * Destroy pagination\n     * @public\n     */\n    destroy() {\n      if (this.container) {\n        this.container.remove();\n        this.container = null;\n      }\n      this.afs.logger.debug('Pagination destroyed');\n    }\n  }","/**\n * @fileoverview URL state management for AFS\n * @version 1.0.0\n */\n\nexport class URLManager {\n  /**\n   * @param {import('../AFS').AFS} afs - Main AFS instance\n   */\n  constructor(afs) {\n    this.afs = afs;\n    this.defaultParams = new URLSearchParams();\n    this.setupPopStateHandler();\n    \n    // Load URL state after a small delay to ensure all features are ready\n    setTimeout(() => {\n      this.loadFromURL();\n    }, 0);\n  }\n\n  /**\n   * Setup history popstate handler\n   * @private\n   */\n  setupPopStateHandler() {\n    window.addEventListener('popstate', () => {\n      this.loadFromURL();\n    });\n  }\n\n  /**\n   * Update URL with current filter state\n   * @public\n   */\n  /**\n * Update URL with current filter state\n * @public\n */\nupdateURL() {\n  this.afs.logger.debug(\"Updating URL state\");\n  const params = new URLSearchParams();\n  const state = this.afs.state.getState();  // Get current state of filters\n\n  // Get active filters directly from the Filter instance\n  const activeFilters = this.afs.filter.getActiveFilters();\n\n  // Update the state object with the active filters\n  state.filters.current = activeFilters;\n\n  // Add filters to URL\n  this.addFiltersToURL(params, state);\n  \n  // Add ranges (if applicable) to URL\n  this.addRangesToURL(params, state);\n  \n  // Add search query to URL\n  this.addSearchToURL(params, state);\n  \n  // Add sort state to URL\n  this.addSortToURL(params, state);\n  \n  // Add pagination to URL\n  this.addPaginationToURL(params, state);\n  \n  // Push the updated URL\n  this.pushState(params);  // Push the new URL state to the browser\n}\n\n  /**\n   * Add filters to URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   * @param {Object} state\n   */\n  addFiltersToURL(params, state) {\n    const filters = state.filters;\n\n    // Skip if only default filter is active\n    if (filters.current.size === 0 || \n        (filters.current.size === 1 && filters.current.has('*'))) {\n      return;\n    }\n\n    // Group filters by type\n    const filtersByType = {};\n    for (const filter of filters.current) {\n      if (filter !== '*') {\n        const [type, value] = filter.split(':');\n        if (!filtersByType[type]) {\n          filtersByType[type] = new Set();\n        }\n        filtersByType[type].add(value);\n      }\n    }\n\n    // Add filters to params\n    Object.entries(filtersByType).forEach(([type, values]) => {\n      params.set(type, Array.from(values).join(','));\n    });\n\n    // Add filter mode if not default\n    if (filters.mode !== 'OR') {\n      params.set('filterMode', filters.mode.toLowerCase());\n    }\n\n    // Add group mode if groups exist and mode isn't default\n    if (filters.groups.size > 0 && filters.groupMode !== 'OR') {\n      params.set('groupMode', filters.groupMode.toLowerCase());\n    }\n\n    // Add filter groups if they exist\n    filters.groups.forEach((group, groupId) => {\n      params.set(`group_${groupId}`, Array.from(group.filters).join(','));\n      if (group.operator !== 'OR') {\n        params.set(`groupOp_${groupId}`, group.operator.toLowerCase());\n      }\n    });\n  }\n\n  /**\n   * Add range filters to URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   * @param {Object} state\n   */\n  addRangesToURL(params, state) {\n    // Handle numeric ranges\n    state.filters.ranges.forEach((range, key) => {\n      const { currentMin, currentMax } = range;\n      if (currentMin !== range.min || currentMax !== range.max) {\n        params.set(`range_${key}`, `${currentMin},${currentMax}`);\n      }\n    });\n\n    // Handle date ranges\n    state.filters.dateRanges.forEach((range, key) => {\n      const { start, end } = range;\n      params.set(`dateRange_${key}`, `${start.toISOString()},${end.toISOString()}`);\n    });\n  }\n\n  /**\n   * Add search parameters to URL\n   * @private\n   * @param {URLSearchParams} params\n   * @param {Object} state\n   */\n  addSearchToURL(params, state) {\n    if (state.search.query) {\n      params.set('search', state.search.query);\n    }\n  }\n\n  /**\n   * Add sort parameters to URL\n   * @private\n   * @param {URLSearchParams} params\n   * @param {Object} state\n   */\n  addSortToURL(params, state) {\n    if (state.sort.current) {\n      const { key, direction } = state.sort.current;\n      params.set('sort', `${key},${direction}`);\n    }\n  }\n\n  /**\n   * Add pagination parameters to URL\n   * @private\n   * @param {URLSearchParams} params\n   * @param {Object} state\n   */\n  addPaginationToURL(params, state) {\n    const { currentPage, itemsPerPage } = state.pagination;\n    if (currentPage > 1) {\n      params.set('page', currentPage.toString());\n    }\n    if (itemsPerPage !== this.afs.options.get('pagination.itemsPerPage')) {\n      params.set('perPage', itemsPerPage.toString());\n    }\n  }\n\n  /**\n   * Update browser URL\n   * @private\n   * @param {URLSearchParams} params\n   */\n  pushState(params) {\n    const queryString = params.toString();\n    const newURL = `${window.location.pathname}${queryString ? '?' + queryString : ''}`;\n    \n    // Only update if URL actually changed\n    if (newURL !== window.location.href) {\n      window.history.pushState({}, '', newURL);\n      this.afs.logger.debug('URL updated:', newURL);\n    }\n  }\n\n  /**\n * Load filter state from URL\n * @public\n */\nloadFromURL() {\n  this.afs.logger.debug('Loading state from URL');\n  const params = new URLSearchParams(window.location.search);\n\n  try {\n    // Clear existing state first\n    if (this.afs.filter) {\n      this.afs.filter.clearAllFilters();\n    }\n\n    // Process filter mode first\n    const filterMode = params.get('filterMode');\n    if (filterMode && this.afs.filter) {\n      this.afs.filter.setFilterMode(filterMode.toUpperCase());\n    }\n\n    // Process regular filters\n    const filterParams = Array.from(params.entries()).filter(([key]) => this.isRegularFilter(key));\n    if (filterParams.length > 0 && this.afs.filter) {\n      // Remove default '*' filter\n      this.afs.filter.activeFilters.clear();\n      \n      // Add filters and update button states\n      filterParams.forEach(([type, values]) => {\n        values.split(',').forEach(value => {\n          const filter = `${type}:${value}`;\n          this.afs.filter.activeFilters.add(filter);\n          \n          // Update button UI\n          this.afs.filter.filterButtons.forEach((buttonFilter, button) => {\n            if (buttonFilter === filter) {\n              button.classList.add(this.afs.options.get('activeClass'));\n            } else if (buttonFilter === '*') {\n              button.classList.remove(this.afs.options.get('activeClass'));\n            }\n          });\n        });\n      });\n    }\n\n    // Apply filters before processing other parameters\n    if (this.afs.filter) {\n      this.afs.filter.applyFilters();\n    }\n\n    // Process search\n    const searchQuery = params.get('search');\n    if (searchQuery && this.afs.search) {\n      this.afs.search.setValue(searchQuery);\n    }\n\n    // Process sort\n    const sortParam = params.get('sort');\n    if (sortParam && this.afs.sort) {\n      const [key, direction] = sortParam.split(',');\n      this.afs.sort.sort(key, direction);\n    }\n\n    // Process pagination\n    const page = parseInt(params.get('page'));\n    if (!isNaN(page) && this.afs.pagination) {\n      this.afs.pagination.goToPage(page);\n    }\n\n    this.afs.emit('urlStateLoaded', { params: Object.fromEntries(params) });\n    this.afs.logger.info('State loaded from URL');\n  } catch (error) {\n    this.afs.logger.error('Error loading state from URL:', error);\n    // Reset to default state on error\n    if (this.afs.filter) {\n      this.afs.filter.clearAllFilters();\n    }\n  }\n}\n  \n  /**\n   * Process filters from URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   */\n  processFiltersFromURL(params) {\n    const state = this.afs.state.getState();\n    let hasFilters = false;\n\n    // Process filter mode\n    const filterMode = params.get('filterMode');\n    if (filterMode) {\n      state.filters.mode = filterMode.toUpperCase();\n    }\n\n    // Process group mode\n    const groupMode = params.get('groupMode');\n    if (groupMode) {\n      state.filters.groupMode = groupMode.toUpperCase();\n    }\n\n    // Process regular filters\n    for (const [type, values] of params.entries()) {\n      if (this.isRegularFilter(type)) {\n        values.split(',').filter(Boolean).forEach(value => {\n          hasFilters = true;\n          state.filters.current.add(`${type}:${value}`);\n        });\n      }\n    }\n\n    // Process filter groups\n    for (const [key, value] of params.entries()) {\n      if (key.startsWith('group_')) {\n        const groupId = key.replace('group_', '');\n        const operator = params.get(`groupOp_${groupId}`)?.toUpperCase() || 'OR';\n        state.filters.groups.set(groupId, {\n          filters: new Set(value.split(',')),\n          operator\n        });\n      }\n    }\n\n    // Set default if no filters\n    if (!hasFilters && state.filters.groups.size === 0) {\n      state.filters.current.add('*');\n    }\n  }\n\n  /**\n   * Process range filters from URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   */\n  processRangesFromURL(params) {\n    const state = this.afs.state.getState();\n\n    // Process numeric ranges\n    for (const [key, value] of params.entries()) {\n      if (key.startsWith('range_')) {\n        const rangeKey = key.replace('range_', '');\n        const [min, max] = value.split(',').map(Number);\n        state.filters.ranges.set(rangeKey, { currentMin: min, currentMax: max });\n      }\n    }\n\n    // Process date ranges\n    for (const [key, value] of params.entries()) {\n      if (key.startsWith('dateRange_')) {\n        const rangeKey = key.replace('dateRange_', '');\n        const [start, end] = value.split(',').map(str => new Date(str));\n        state.filters.dateRanges.set(rangeKey, { start, end });\n      }\n    }\n  }\n\n  /**\n   * Process search from URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   */\n  processSearchFromURL(params) {\n    const searchQuery = params.get('search') || '';\n    this.afs.state.setState('search.query', searchQuery);\n    \n    if (this.afs.options.get('searchInput')) {\n      this.afs.options.get('searchInput').value = searchQuery;\n    }\n  }\n\n  /**\n   * Process sort from URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   */\n  processSortFromURL(params) {\n    const sortParam = params.get('sort');\n    if (sortParam) {\n      const [key, direction] = sortParam.split(',');\n      this.afs.state.setState('sort.current', { key, direction });\n    }\n  }\n\n  /**\n   * Process pagination from URL parameters\n   * @private\n   * @param {URLSearchParams} params\n   */\n  processPaginationFromURL(params) {\n    const page = parseInt(params.get('page')) || 1;\n    const perPage = parseInt(params.get('perPage')) || \n                   this.afs.options.get('pagination.itemsPerPage');\n\n    this.afs.state.setState('pagination', {\n      currentPage: page,\n      itemsPerPage: perPage\n    });\n  }\n\n  /**\n   * Check if parameter is a regular filter\n   * @private\n   * @param {string} param - Parameter name\n   * @returns {boolean}\n   */\n  isRegularFilter(param) {\n    const excludedParams = [\n      'search', 'sort', 'page', 'perPage', 'filterMode', 'groupMode'\n    ];\n    return !excludedParams.includes(param) && \n           !param.startsWith('group_') && \n           !param.startsWith('groupOp_') && \n           !param.startsWith('range_') && \n           !param.startsWith('dateRange_');\n  }\n\n  /**\n   * Clear URL parameters\n   * @public\n   */\n  clearURL() {\n    window.history.pushState({}, '', window.location.pathname);\n    this.afs.state.reset();\n    if (this.afs.filter) {\n      this.afs.filter.clearAllFilters();\n    }\n  }\n\n  /**\n   * Get current URL parameters\n   * @public\n   * @returns {URLSearchParams}\n   */\n  getURLParams() {\n    return new URLSearchParams(window.location.search);\n  }\n\n  /**\n   * Check if URL has parameters\n   * @public\n   * @returns {boolean}\n   */\n  hasParams() {\n    return window.location.search.length > 1;\n  }\n\n  /**\n   * Get parameter value\n   * @public\n   * @param {string} param - Parameter name\n   * @returns {string|null}\n   */\n  getParam(param) {\n    return new URLSearchParams(window.location.search).get(param);\n  }\n}","/**\n * @fileoverview Range filter implementation for AFS\n * @version 1.0.0\n */\n\nimport { debounce } from \"../utils\";\nimport { StyleManager } from \"../styles/StyleManager\";\n\nexport class RangeFilter {\n  constructor(afs) {\n    this.afs = afs;\n    this.activeRanges = new Map();\n\n    if (!this.afs.styleManager) {\n      this.afs.styleManager = new StyleManager(this.afs.options);\n    }\n\n    // Apply styles immediately\n    this.afs.styleManager.applyStyles();\n  }\n\n  /**\n   * @typedef {Object} RangeOptions\n   * @property {string} key - Data attribute key\n   * @property {string} type - Type of range ('number' or 'date')\n   * @property {HTMLElement} container - Container element\n   * @property {number|string} [min] - Minimum value\n   * @property {number|string} [max] - Maximum value\n   * @property {number} [step] - Step value\n   */\n\n  /**\n   * Add range slider\n   * @param {RangeOptions} options - Range slider options\n   */\n  addRangeSlider({ key, type, container, min, max, step = 1, ui }) {\n    this.afs.logger.debug(`Adding range slider for ${key}`);\n\n    if (!container) {\n      this.afs.logger.error(\"Container element required for range slider\");\n      return;\n    }\n\n    // Calculate min/max if not provided\n    const values = this.calculateMinMax(key, type);\n    min = min ?? values.min;\n    max = max ?? values.max;\n\n    // Get global UI options and merge with slider-specific options\n    const globalUiOptions = this.afs.options.get(\"styles.slider.ui\") || {\n      showHistogram: false,\n      bins: 10,\n    };\n    const sliderUiOptions = {\n      ...globalUiOptions,\n      ...ui, // Override with slider-specific options if provided\n    };\n\n    // Only calculate histogram data if enabled\n    const histogramData = sliderUiOptions.showHistogram\n      ? this.calculateHistogramData(key, sliderUiOptions.bins)\n      : { counts: [], binEdges: [], max: 0 };\n\n    // Create slider elements\n    const elements = this.createSliderElements(histogramData, sliderUiOptions);\n    const state = this.initializeState(min, max, step, type);\n\n    // Store histogram data and UI options in state\n    state.ui = sliderUiOptions;\n    if (sliderUiOptions.showHistogram) {\n      state.histogram = histogramData;\n    }\n\n    // Add elements to container\n    this.appendElements(container, elements);\n\n    // Setup event handlers\n    this.setupEventHandlers(elements, state, key);\n\n    // Store state\n    this.activeRanges.set(key, { state, elements });\n\n    // Initial update\n    this.updateSliderUI(key);\n\n    // Setup histogram highlight updates only if enabled\n    if (sliderUiOptions.showHistogram) {\n      this.setupHistogramHighlight(elements, state, histogramData.binEdges);\n    }\n\n    this.afs.logger.info(`Range slider added for ${key}`);\n  }\n  /**\n   * Calculate min and max values from items\n   * @private\n   */\n  calculateMinMax(key, type) {\n    const values = Array.from(this.afs.items)\n      .map((item) => {\n        const value = item.dataset[key];\n        return type === \"date\" ? new Date(value).getTime() : parseFloat(value);\n      })\n      .filter((value) => !isNaN(value));\n\n    return {\n      min: Math.min(...values),\n      max: Math.max(...values),\n    };\n  }\n\n  /**\n   * Create slider DOM elements\n   * @private\n   * @param {Object} histogramData - Histogram data\n   * @param {Object} sliderUiOptions - UI options for this slider\n   */\n  createSliderElements(histogramData, sliderUiOptions) {\n    const styles =\n      this.afs.options.get(\"styles\") || this.afs.styleManager.defaultStyles;\n    const sliderStyles =\n      styles.slider || this.afs.styleManager.defaultStyles.slider;\n    const colors = styles.colors || this.afs.styleManager.defaultStyles.colors;\n\n    const container = document.createElement(\"div\");\n    container.className = \"price-range-container\";\n\n    const slider = document.createElement(\"div\");\n    slider.className = sliderStyles.class;\n\n    const track = document.createElement(\"div\");\n    track.className = sliderStyles.trackClass;\n\n    // Only add histogram if enabled in the slider-specific options\n    if (sliderUiOptions?.showHistogram && histogramData?.counts?.length > 0) {\n      const histogram = this.createHistogramBars(histogramData, colors);\n      slider.appendChild(histogram);\n    }\n\n    const selectedRange = document.createElement(\"div\");\n    selectedRange.className = sliderStyles.selectedClass;\n\n    const minThumb = document.createElement(\"div\");\n    minThumb.className = sliderStyles.thumbClass;\n\n    const maxThumb = document.createElement(\"div\");\n    maxThumb.className = sliderStyles.thumbClass;\n\n    const minValue = document.createElement(\"div\");\n    minValue.className = sliderStyles.valueClass;\n\n    const maxValue = document.createElement(\"div\");\n    maxValue.className = sliderStyles.valueClass;\n\n    // Build the slider\n    slider.appendChild(track);\n    slider.appendChild(selectedRange);\n    slider.appendChild(minThumb);\n    slider.appendChild(maxThumb);\n    slider.appendChild(minValue);\n    slider.appendChild(maxValue);\n\n    container.appendChild(slider);\n\n    return {\n      container,\n      slider,\n      track,\n      selectedRange,\n      minThumb,\n      maxThumb,\n      minValue,\n      maxValue,\n    };\n  }\n\n  // Add helper method for creating histogram\n  createHistogram(data, colors) {\n    const histogram = document.createElement(\"div\");\n    histogram.className = \"afs-histogram\";\n\n    // Create histogram bars\n    data.forEach((value, index) => {\n      const bar = document.createElement(\"div\");\n      bar.className = \"afs-histogram-bar\";\n      bar.style.height = `${value}%`;\n      bar.style.backgroundColor = colors.histogram;\n      histogram.appendChild(bar);\n    });\n\n    return histogram;\n  }\n\n  /**\n   * Calculate histogram data from items\n   * @private\n   * @param {string} key - Data attribute key (e.g., 'price')\n   * @param {number} [bins=10] - Number of bins for histogram\n   * @returns {Object} Histogram data and metadata\n   */\n  calculateHistogramData(key, bins = 10) {\n    try {\n      const values = Array.from(this.afs.items)\n        .map((item) => parseFloat(item.dataset[key]))\n        .filter((value) => !isNaN(value));\n\n      if (values.length === 0) {\n        return { counts: [], binEdges: [], max: 0 };\n      }\n\n      const min = Math.min(...values);\n      const max = Math.max(...values);\n      const binWidth = (max - min) / bins;\n\n      const counts = new Array(bins).fill(0);\n      const binEdges = new Array(bins + 1);\n\n      // Calculate bin edges\n      for (let i = 0; i <= bins; i++) {\n        binEdges[i] = min + i * binWidth;\n      }\n\n      // Count values in each bin\n      values.forEach((value) => {\n        if (value === max) {\n          counts[counts.length - 1]++;\n          return;\n        }\n\n        const binIndex = Math.floor((value - min) / binWidth);\n        counts[binIndex]++;\n      });\n\n      // Normalize heights to be more subtle\n      const maxCount = Math.max(...counts);\n      const normalizedCounts = counts.map(\n        (count) => Math.max(20, Math.round((count / maxCount) * 100)), // Minimum height of 20%\n      );\n\n      return {\n        counts: normalizedCounts,\n        binEdges,\n        max: maxCount,\n        min,\n        max,\n      };\n    } catch (error) {\n      this.afs.logger.error(\"Error calculating histogram:\", error);\n      return { counts: [], binEdges: [], max: 0 };\n    }\n  }\n\n  /**\n   * Setup histogram highlight on range changes\n   * @private\n   */\n  setupHistogramHighlight(elements, state, binEdges) {\n    const bars = elements.slider.querySelectorAll(\".afs-histogram-bar\");\n\n    const updateHistogram = () => {\n      const minVal = state.currentMin;\n      const maxVal = state.currentMax;\n\n      bars.forEach((bar, index) => {\n        const binStart = binEdges[index];\n        const binEnd = binEdges[index + 1];\n\n        // Highlight bars within the selected range\n        if (binStart >= minVal && binEnd <= maxVal) {\n          bar.classList.add(\"active\");\n        } else {\n          bar.classList.remove(\"active\");\n        }\n      });\n    };\n\n    // Update histogram on range changes using AFS instance\n    this.afs.on(\"rangeFilter\", () => updateHistogram());\n\n    // Initial update\n    updateHistogram();\n  }\n\n  /**\n   * Create histogram bars\n   * @private\n   */\n  createHistogramBars(histogramData, colors) {\n    const { counts } = histogramData;\n    const histogram = document.createElement(\"div\");\n    histogram.className = \"afs-histogram\";\n\n    counts.forEach((height) => {\n      const bar = document.createElement(\"div\");\n      bar.className = \"afs-histogram-bar\";\n      bar.style.height = `${height}%`;\n      histogram.appendChild(bar);\n    });\n\n    return histogram;\n  }\n\n  /**\n   * Initialize slider state\n   * @private\n   */\n  initializeState(min, max, step, type) {\n    return {\n      min,\n      max,\n      currentMin: min,\n      currentMax: max,\n      step,\n      type,\n      isDragging: false,\n    };\n  }\n\n  /**\n   * Append elements to container\n   * @private\n   */\n  appendElements(container, elements) {\n    const {\n      slider,\n      track,\n      selectedRange,\n      minThumb,\n      maxThumb,\n      minValue,\n      maxValue,\n    } = elements;\n\n    slider.appendChild(track);\n    slider.appendChild(selectedRange);\n    slider.appendChild(minThumb);\n    slider.appendChild(maxThumb);\n    slider.appendChild(minValue);\n    slider.appendChild(maxValue);\n    container.appendChild(slider);\n  }\n\n  /**\n   * Setup event handlers for slider\n   * @private\n   */\n  setupEventHandlers(elements, state, key) {\n    const { minThumb, maxThumb } = elements;\n\n    const handleDragStart = (isMin) => (e) => {\n      state.isDragging = true;\n      const moveHandler = this.createMoveHandler(elements, state, key, isMin);\n      const stopHandler = () => {\n        state.isDragging = false;\n        window.removeEventListener(\"mousemove\", moveHandler);\n        window.removeEventListener(\"mouseup\", stopHandler);\n        this.applyFilter(key);\n      };\n\n      window.addEventListener(\"mousemove\", moveHandler);\n      window.addEventListener(\"mouseup\", stopHandler);\n    };\n\n    minThumb.addEventListener(\"mousedown\", handleDragStart(true));\n    maxThumb.addEventListener(\"mousedown\", handleDragStart(false));\n  }\n\n  /**\n   * Update slider UI\n   * @private\n   */\n  updateSliderUI(key) {\n    const { state, elements } = this.activeRanges.get(key);\n    const { minThumb, maxThumb, selectedRange, minValue, maxValue } = elements;\n\n    // Calculate positions with padding consideration\n    const range = state.max - state.min;\n    const minPos = ((state.currentMin - state.min) / range) * 100;\n    const maxPos = ((state.currentMax - state.min) / range) * 100;\n\n    // Ensure thumbs stay within bounds\n    const clampedMinPos = Math.max(0, Math.min(minPos, 100));\n    const clampedMaxPos = Math.max(0, Math.min(maxPos, 100));\n\n    // Position thumbs\n    minThumb.style.left = `${clampedMinPos}%`;\n    maxThumb.style.left = `${clampedMaxPos}%`;\n\n    // Position selected range\n    selectedRange.style.left = `${clampedMinPos}%`;\n    selectedRange.style.width = `${clampedMaxPos - clampedMinPos}%`;\n\n    // Format values\n    const formatValue =\n      state.type === \"date\"\n        ? (value) => new Date(value).toLocaleDateString()\n        : (value) => value.toFixed(2);\n\n    // Update value labels\n    minValue.textContent = formatValue(state.currentMin);\n    maxValue.textContent = formatValue(state.currentMax);\n\n    // Position value labels considering bounds\n    minValue.style.left = `${clampedMinPos}%`;\n    maxValue.style.left = `${clampedMaxPos}%`;\n\n    // Handle edge cases for value label positioning\n    if (clampedMinPos < 5) {\n      minValue.style.transform = \"translateX(0)\";\n    } else if (clampedMinPos > 95) {\n      minValue.style.transform = \"translateX(-100%)\";\n    } else {\n      minValue.style.transform = \"translateX(-50%)\";\n    }\n\n    if (clampedMaxPos < 5) {\n      maxValue.style.transform = \"translateX(0)\";\n    } else if (clampedMaxPos > 95) {\n      maxValue.style.transform = \"translateX(-100%)\";\n    } else {\n      maxValue.style.transform = \"translateX(-50%)\";\n    }\n  }\n\n  // Also update the createMoveHandler to respect the padding\n  createMoveHandler(elements, state, key, isMin) {\n    this.afs.logger.debug(`Creating move handler for ${key}`);\n\n    const { track } = elements;\n    const PADDING = 5;\n\n    return debounce((e) => {\n      const rect = track.getBoundingClientRect();\n      const totalWidth = rect.width;\n      const paddingPixels = (PADDING / 100) * totalWidth;\n\n      // Calculate percent with padding consideration\n      const rawPercent =\n        (e.clientX - rect.left - paddingPixels) /\n        (totalWidth - 2 * paddingPixels);\n      const percent = Math.min(Math.max(0, rawPercent), 1);\n\n      // Calculate value considering the full range\n      const value = state.min + (state.max - state.min) * percent;\n      const stepped = Math.round(value / state.step) * state.step;\n\n      if (isMin) {\n        state.currentMin = Math.min(stepped, state.currentMax);\n      } else {\n        state.currentMax = Math.max(stepped, state.currentMin);\n      }\n\n      this.updateSliderUI(key);\n    }, 16); // ~60fps\n  }\n\n  /**\n   * Apply range filter\n   * @private\n   */\n  applyFilter(key) {\n    this.afs.logger.debug(`Applying range filter for ${key}`);\n\n    const { state } = this.activeRanges.get(key);\n\n    this.afs.items.forEach((item) => {\n      const value =\n        state.type === \"date\"\n          ? new Date(item.dataset[key]).getTime()\n          : parseFloat(item.dataset[key]);\n\n      if (value >= state.currentMin && value <= state.currentMax) {\n        this.afs.showItem(item);\n      } else {\n        this.afs.hideItem(item);\n      }\n    });\n\n    this.afs.updateCounter();\n    this.afs.urlManager.updateURL();\n    this.afs.emit(\"rangeFilter\", {\n      key,\n      min: state.currentMin,\n      max: state.currentMax,\n    });\n  }\n\n  /**\n   * Get current range values\n   * @param {string} key - Range key\n   * @returns {Object} Current range values\n   */\n  getRangeValues(key) {\n    const range = this.activeRanges.get(key);\n    if (!range) return null;\n\n    return {\n      min: range.state.currentMin,\n      max: range.state.currentMax,\n      type: range.state.type,\n    };\n  }\n\n  /**\n   * Set range values\n   * @param {string} key - Range key\n   * @param {number} min - Minimum value\n   * @param {number} max - Maximum value\n   */\n  setRangeValues(key, min, max) {\n    const range = this.activeRanges.get(key);\n    if (!range) return;\n\n    range.state.currentMin = min;\n    range.state.currentMax = max;\n    this.updateSliderUI(key);\n    this.applyFilter(key);\n  }\n\n  /**\n   * Remove range slider\n   * @param {string} key - Range key\n   */\n  removeRangeSlider(key) {\n    const range = this.activeRanges.get(key);\n    if (!range) return;\n\n    range.elements.slider.remove();\n    this.activeRanges.delete(key);\n    this.afs.logger.info(`Range slider removed for ${key}`);\n  }\n}\n","/**\n * @fileoverview Date filter implementation for AFS\n * @version 1.0.0\n */\n\nimport { debounce } from '../utils';\n\nexport class DateFilter {\n  constructor(afs) {\n    this.afs = afs;\n    this.activeDateRanges = new Map();\n    this.defaultFormat = this.afs.options.get('dateFormat') || 'YYYY-MM-DD';\n  }\n\n  /**\n   * @typedef {Object} DateRangeOptions\n   * @property {string} key - Data attribute key\n   * @property {HTMLElement} container - Container element\n   * @property {Date} [minDate] - Minimum date\n   * @property {Date} [maxDate] - Maximum date\n   * @property {string} [format] - Date format (default: YYYY-MM-DD)\n   */\n\n  /**\n   * Add date range filter\n   * @param {DateRangeOptions} options - Date range options\n   */\n  addDateRange({ key, container, minDate, maxDate, format = this.defaultFormat }) {\n    this.afs.logger.debug(`Adding date range for ${key}`);\n\n    if (!container) {\n      this.afs.logger.error('Container element required for date range');\n      return;\n    }\n\n    // Calculate min/max dates if not provided\n    const dates = this.calculateMinMaxDates(key);\n    minDate = minDate ?? dates.min;\n    maxDate = maxDate ?? dates.max;\n\n    // Create date picker elements\n    const elements = this.createDateElements();\n    const state = this.initializeState(minDate, maxDate, format);\n\n    // Add elements to container\n    this.appendElements(container, elements);\n\n    // Setup event handlers\n    this.setupEventHandlers(elements, state, key);\n\n    // Store state\n    this.activeDateRanges.set(key, { state, elements });\n\n    // Initial update\n    this.updateDateUI(key);\n\n    this.afs.logger.info(`Date range added for ${key}`);\n  }\n\n  /**\n   * Calculate min and max dates from items\n   * @private\n   */\n  calculateMinMaxDates(key) {\n    try {\n      const validDates = Array.from(this.afs.items)\n        .map(item => {\n          if (!item || !item.dataset || !item.dataset[key]) {\n            return null;\n          }\n          const date = new Date(item.dataset[key]);\n          return isNaN(date.getTime()) ? null : date;\n        })\n        .filter(date => date !== null);\n  \n      if (validDates.length === 0) {\n        // Return default date range if no valid dates found\n        const today = new Date();\n        return {\n          min: new Date(today.getFullYear(), 0, 1), // January 1st of current year\n          max: new Date(today.getFullYear(), 11, 31) // December 31st of current year\n        };\n      }\n  \n      return {\n        min: new Date(Math.min(...validDates)),\n        max: new Date(Math.max(...validDates))\n      };\n    } catch (error) {\n      this.afs.logger.error('Error calculating date range:', error);\n      // Return default date range on error\n      const today = new Date();\n      return {\n        min: new Date(today.getFullYear(), 0, 1),\n        max: new Date(today.getFullYear(), 11, 31)\n      };\n    }\n  }\n\n  /**\n   * Create date picker elements\n   * @private\n   */\n  createDateElements() {\n    this.afs.logger.debug('Creating date picker elements');\n\n    const container = document.createElement('div');\n    container.className = 'afs-date-range-container';\n\n    const startContainer = document.createElement('div');\n    startContainer.className = 'afs-date-input-wrapper';\n    \n    const startLabel = document.createElement('label');\n    startLabel.textContent = 'Start Date';\n    \n    const startInput = document.createElement('input');\n    startInput.type = 'date';\n    startInput.className = 'afs-date-input start-date';\n\n    const endContainer = document.createElement('div');\n    endContainer.className = 'afs-date-input-wrapper';\n    \n    const endLabel = document.createElement('label');\n    endLabel.textContent = 'End Date';\n    \n    const endInput = document.createElement('input');\n    endInput.type = 'date';\n    endInput.className = 'afs-date-input end-date';\n\n    startContainer.appendChild(startLabel);\n    startContainer.appendChild(startInput);\n    endContainer.appendChild(endLabel);\n    endContainer.appendChild(endInput);\n\n    container.appendChild(startContainer);\n    container.appendChild(endContainer);\n\n    return {\n      container,\n      startInput,\n      endInput\n    };\n  }\n\n  /**\n   * Initialize date filter state\n   * @private\n   */\n  initializeState(minDate, maxDate, format) {\n    return {\n      minDate,\n      maxDate,\n      currentStartDate: minDate,\n      currentEndDate: maxDate,\n      format\n    };\n  }\n\n  /**\n   * Append elements to container\n   * @private\n   */\n  appendElements(container, elements) {\n    container.appendChild(elements.container);\n  }\n\n  /**\n   * Setup event handlers\n   * @private\n   */\n  setupEventHandlers(elements, state, key) {\n    this.afs.logger.debug(`Setting up event handlers for date range ${key}`);\n\n    const { startInput, endInput } = elements;\n\n    const handleDateChange = debounce(() => {\n      const startDate = new Date(startInput.value);\n      const endDate = new Date(endInput.value);\n\n      if (!isNaN(startDate.getTime()) && !isNaN(endDate.getTime())) {\n        state.currentStartDate = startDate;\n        state.currentEndDate = endDate;\n        this.applyDateFilter(key);\n      }\n    }, 300);\n\n    startInput.addEventListener('change', handleDateChange);\n    endInput.addEventListener('change', handleDateChange);\n  }\n\n  /**\n   * Update date picker UI\n   * @private\n   */\n  updateDateUI(key) {\n    try {\n      const { state, elements } = this.activeDateRanges.get(key);\n      const { startInput, endInput } = elements;\n  \n      // Format dates for input\n      const formatDate = date => {\n        try {\n          const d = new Date(date);\n          if (isNaN(d.getTime())) {\n            throw new Error('Invalid date');\n          }\n          return d.toISOString().split('T')[0];\n        } catch (error) {\n          this.afs.logger.error('Error formatting date:', error);\n          return '';\n        }\n      };\n  \n      // Set min/max constraints\n      startInput.min = formatDate(state.minDate);\n      startInput.max = formatDate(state.maxDate);\n      endInput.min = formatDate(state.minDate);\n      endInput.max = formatDate(state.maxDate);\n  \n      // Set current values\n      startInput.value = formatDate(state.currentStartDate);\n      endInput.value = formatDate(state.currentEndDate);\n    } catch (error) {\n      this.afs.logger.error('Error updating date UI:', error);\n    }\n  }\n\n  /**\n   * Apply date filter\n   * @private\n   */\n  applyDateFilter(key) {\n    this.afs.logger.info(`Applying date filter for ${key}`);\n    const { state } = this.activeDateRanges.get(key);\n  \n    this.afs.items.forEach(item => {\n      try {\n        // Check if item and dataset exist\n        if (!item || !item.dataset || !item.dataset[key]) {\n          this.afs.hideItem(item);\n          return;\n        }\n  \n        const itemDate = new Date(item.dataset[key]);\n        \n        // Check if date is valid\n        if (isNaN(itemDate.getTime())) {\n          this.afs.hideItem(item);\n          return;\n        }\n  \n        // Set time to midnight for consistent comparison\n        const startDate = new Date(state.currentStartDate);\n        startDate.setHours(0, 0, 0, 0);\n        \n        const endDate = new Date(state.currentEndDate);\n        endDate.setHours(23, 59, 59, 999);\n        \n        const compareDate = new Date(itemDate);\n        compareDate.setHours(0, 0, 0, 0);\n  \n        if (compareDate >= startDate && compareDate <= endDate) {\n          this.afs.showItem(item);\n        } else {\n          this.afs.hideItem(item);\n        }\n      } catch (error) {\n        this.afs.logger.error('Error filtering item by date:', error);\n        this.afs.hideItem(item);\n      }\n    });\n  \n    this.afs.updateCounter();\n    this.afs.urlManager.updateURL();\n    this.afs.emit('dateFilter', {\n      key,\n      startDate: state.currentStartDate,\n      endDate: state.currentEndDate\n    });\n  }\n\n  /**\n   * Get current date range\n   * @param {string} key - Date range key\n   * @returns {Object} Current date range\n   */\n  getDateRange(key) {\n    const range = this.activeDateRanges.get(key);\n    if (!range) return null;\n\n    return {\n      startDate: range.state.currentStartDate,\n      endDate: range.state.currentEndDate\n    };\n  }\n\n  /**\n   * Set date range\n   * @param {string} key - Date range key\n   * @param {Date} startDate - Start date\n   * @param {Date} endDate - End date\n   */\n  setDateRange(key, startDate, endDate) {\n    const range = this.activeDateRanges.get(key);\n    if (!range) return;\n\n    range.state.currentStartDate = startDate;\n    range.state.currentEndDate = endDate;\n    this.updateDateUI(key);\n    this.applyDateFilter(key);\n  }\n\n  /**\n   * Remove date range\n   * @param {string} key - Date range key\n   */\n  removeDateRange(key) {\n    const range = this.activeDateRanges.get(key);\n    if (!range) return;\n\n    range.elements.container.remove();\n    this.activeDateRanges.delete(key);\n    this.afs.logger.info(`Date range removed for ${key}`);\n  }\n}","/**\n * @fileoverview Advanced Filter System - Main Class\n */\nimport { Logger } from \"./core/Logger\";\nimport { Options } from \"./core/Options\";\nimport { State } from \"./core/State\";\nimport { StyleManager } from \"./styles/StyleManager\";\nimport { EventEmitter } from \"./core/EventEmitter\";\n\nimport { Filter } from \"./features/Filter\";\nimport { Search } from \"./features/Search\";\nimport { Sort } from \"./features/Sort\";\nimport { Pagination } from \"./features/Pagination\";\nimport { URLManager } from \"./features/URLManager\";\nimport { RangeFilter } from \"./features/RangeFilter\";\nimport { DateFilter } from \"./features/DateFilter\";\n\nimport { debounce } from \"./utils\";\n\n// Version\nexport const VERSION = '1.0.6';\n\nexport class AFS extends EventEmitter {\n  /**\n   * @param {Object} options - Configuration options\n   */\n  constructor(options = {}) {\n    super();\n    this.initializeCore(options);\n  }\n\n  /**\n   * Initialize core components\n   * @private\n   */\n  initializeCore(options) {\n    try {\n      this.options = new Options(options);\n      this.logger = new Logger(\n        this.options.get(\"debug\") || false,\n        this.options.get(\"logLevel\") || \"info\",\n      );\n      this.state = new State();\n      this.styleManager = new StyleManager(this.options);\n\n      this.initializeDOM();\n      this.initializeFeatures();\n      this.setupLifecycle();\n    } catch (error) {\n      console.error(\"AFS initialization error:\", error);\n      throw error;\n    }\n  }\n\n  /**\n   * Initialize DOM elements\n   * @private\n   */\n  initializeDOM() {\n    this.logger.debug(\"Initializing DOM elements\");\n\n    this.container = document.querySelector(\n      this.options.get(\"containerSelector\"),\n    );\n    if (!this.container) {\n      throw new Error(\n        `Container not found: ${this.options.get(\"containerSelector\")}`,\n      );\n    }\n\n    this.items = this.container.querySelectorAll(\n      this.options.get(\"itemSelector\"),\n    );\n    if (this.items.length === 0) {\n      this.logger.warn(\"No items found in container\");\n    }\n\n    this.state.setState(\"items.total\", this.items.length);\n    this.state.setState(\"items.visible\", new Set(this.items));\n  }\n\n  /**\n   * Initialize features\n   * @private\n   */\n  initializeFeatures() {\n    this.logger.debug(\"Initializing features\");\n\n    // Then initialize other features\n    this.filter = new Filter(this);\n    this.search = new Search(this);\n    this.sort = new Sort(this);\n    this.pagination = new Pagination(this);\n    this.rangeFilter = new RangeFilter(this);\n    this.urlManager = new URLManager(this);\n    this.dateFilter = new DateFilter(this);\n\n    // Apply styles\n    this.styleManager.applyStyles();\n\n    // Load initial state from URL\n    this.urlManager.loadFromURL();\n  }\n\n  /**\n   * Setup lifecycle events\n   * @private\n   */\n  setupLifecycle() {\n    if (this.options.get(\"responsive\")) {\n      window.addEventListener(\"resize\", this.handleResize.bind(this));\n    }\n\n    if (this.options.get(\"preserveState\")) {\n      document.addEventListener(\n        \"visibilitychange\",\n        this.handleVisibilityChange.bind(this),\n      );\n    }\n\n    if (this.options.get(\"observeDOM\")) {\n      this.setupMutationObserver();\n    }\n\n    this.emit(\"initialized\", {\n      itemCount: this.items.length,\n      options: this.options.export(),\n    });\n  }\n\n  // Item Management Methods\n  /**\n   * Show item with animation\n   * @public\n   * @param {HTMLElement} item - Item to show\n   */\n  showItem(item) {\n    // Update state first\n    const visibleItems = this.state.getState().items.visible;\n    visibleItems.add(item);\n    this.state.setState(\"items.visible\", visibleItems);\n\n    // Remove hidden class but keep opacity 0 initially\n    item.classList.remove(this.options.get(\"hiddenClass\"));\n\n    // Set initial animation state\n    item.style.opacity = \"0\";\n    item.style.transform = \"scale(0.95)\";\n    item.style.display = \"\"; // Ensure item is not display: none\n\n    // Force reflow before starting animation\n    item.offsetHeight;\n\n    // Add transition class if not present\n    const transitionClass =\n      this.options.get(\"transitionClass\") || \"afs-transition\";\n    if (!item.classList.contains(transitionClass)) {\n      item.classList.add(transitionClass);\n    }\n\n    // Start animation in next frame\n    requestAnimationFrame(() => {\n      requestAnimationFrame(() => {\n        // Double RAF for reliable animation\n        item.style.opacity = \"1\";\n        item.style.transform = \"scale(1)\";\n      });\n    });\n\n    // Clean up after animation\n    const duration = this.options.get(\"animationDuration\") || 300;\n    setTimeout(() => {\n      // Only clean up if item is still meant to be visible\n      if (visibleItems.has(item)) {\n        item.style.transform = \"\";\n        item.style.opacity = \"\";\n      }\n    }, duration);\n  }\n\n  /**\n   * Hide item with animation\n   * @public\n   * @param {HTMLElement} item - Item to hide\n   */\n  hideItem(item) {\n    // Update state first\n    const visibleItems = this.state.getState().items.visible;\n    visibleItems.delete(item);\n    this.state.setState(\"items.visible\", visibleItems);\n\n    // Add transition class if not present\n    const transitionClass =\n      this.options.get(\"transitionClass\") || \"afs-transition\";\n    if (!item.classList.contains(transitionClass)) {\n      item.classList.add(transitionClass);\n    }\n\n    // Start hide animation\n    requestAnimationFrame(() => {\n      item.style.opacity = \"0\";\n      item.style.transform = \"scale(0.95)\";\n    });\n\n    // Add hidden class and clean up after animation\n    const duration = this.options.get(\"animationDuration\") || 300;\n    setTimeout(() => {\n      // Only hide if the item is still meant to be hidden\n      if (!visibleItems.has(item)) {\n        item.classList.add(this.options.get(\"hiddenClass\"));\n        // Clean up styles\n        item.style.transform = \"\";\n        item.style.opacity = \"\";\n      }\n    }, duration);\n  }\n\n  /**\n   * Add new items\n   * @public\n   */\n  addItems(newItems) {\n    const items = Array.isArray(newItems) ? newItems : [newItems];\n    const fragment = document.createDocumentFragment();\n\n    items.forEach((item) => {\n      fragment.appendChild(item);\n      this.state.getState().items.visible.add(item);\n    });\n\n    this.container.appendChild(fragment);\n    this.items = this.container.querySelectorAll(\n      this.options.get(\"itemSelector\"),\n    );\n    this.filter.applyFilters();\n  }\n\n  /**\n   * Remove items\n   * @public\n   */\n  removeItems(itemsToRemove) {\n    const items = Array.isArray(itemsToRemove)\n      ? itemsToRemove\n      : [itemsToRemove];\n    const visibleItems = this.state.getState().items.visible;\n\n    items.forEach((item) => {\n      visibleItems.delete(item);\n      item.remove();\n    });\n\n    this.items = this.container.querySelectorAll(\n      this.options.get(\"itemSelector\"),\n    );\n    this.updateCounter();\n  }\n\n  // State Management Methods\n  /**\n   * Save current state\n   * @public\n   */\n  saveState() {\n    if (!this.options.get(\"preserveState\")) return;\n\n    const state = {\n      filters: Array.from(this.filter.getActiveFilters()),\n      search: this.search.getValue(),\n      sort: this.sort.getCurrentSort(),\n      pagination: this.pagination.getPageInfo(),\n      timestamp: Date.now(),\n    };\n\n    localStorage.setItem(\"afs_state\", JSON.stringify(state));\n    this.logger.debug(\"State saved\");\n  }\n\n  /**\n   * Restore saved state\n   * @public\n   */\n  restoreState() {\n    if (!this.options.get(\"preserveState\")) return;\n\n    try {\n      const saved = localStorage.getItem(\"afs_state\");\n      if (!saved) return;\n\n      const state = JSON.parse(saved);\n      if (Date.now() - state.timestamp > this.options.get(\"stateExpiry\")) {\n        localStorage.removeItem(\"afs_state\");\n        return;\n      }\n\n      this.setState(state);\n      this.logger.debug(\"State restored\");\n    } catch (error) {\n      this.logger.error(\"Error restoring state:\", error);\n    }\n  }\n\n  /**\n   * Get current state\n   * @public\n   */\n  getState() {\n    return this.state.export();\n  }\n\n  /**\n   * Set new state\n   * @public\n   */\n  setState(newState) {\n    this.state.import(newState);\n    this.refresh();\n  }\n\n  // Update Methods\n  /**\n   * Update counter display\n   * @public\n   */\n  updateCounter() {\n    // Get counter element\n    const counterElement = document.querySelector(\n      this.options.get(\"counterSelector\"),\n    );\n    if (!counterElement) return;\n\n    try {\n      // Get count values\n      const total = this.items.length;\n      const visible = this.state.getState().items.visible.size;\n      const filtered = total - visible;\n\n      // Get counter options with defaults\n      const counterOpts =\n        this.options.get(\"counter\") || Options.defaults.counter;\n      const template = counterOpts.template || \"Showing {visible} of {total}\";\n      const formatter =\n        counterOpts.formatter || ((num) => num.toLocaleString());\n\n      // Format numbers\n      const formattedVisible = formatter(visible);\n      const formattedTotal = formatter(total);\n      const formattedFiltered = formatter(filtered);\n\n      // Build counter text\n      let counterText = template\n        .replace(\"{visible}\", formattedVisible)\n        .replace(\"{total}\", formattedTotal)\n        .replace(\"{filtered}\", formattedFiltered);\n\n      // Add filtered count if enabled\n      if (filtered > 0 && counterOpts.showFiltered) {\n        const filteredTemplate =\n          counterOpts.filteredTemplate || \"({filtered} filtered)\";\n        counterText +=\n          \" \" + filteredTemplate.replace(\"{filtered}\", formattedFiltered);\n      }\n\n      // Show no results message if applicable\n      if (visible === 0 && counterOpts.noResultsTemplate) {\n        counterText = counterOpts.noResultsTemplate;\n      }\n\n      // Update counter element\n      counterElement.textContent = counterText;\n\n      // Emit event\n      this.emit(\"counterUpdated\", {\n        total,\n        visible,\n        filtered,\n        formattedTotal,\n        formattedVisible,\n        formattedFiltered,\n      });\n    } catch (error) {\n      // Fallback to basic counter if anything fails\n      this.logger.error(\"Error updating counter:\", error);\n      counterElement.textContent = `${\n        this.state.getState().items.visible.size\n      }/${this.items.length}`;\n    }\n  }\n\n  /**\n   * Update options\n   * @public\n   */\n  updateOptions(newOptions) {\n    this.options.update(newOptions);\n    this.styleManager.updateStyles(newOptions);\n    this.refresh();\n  }\n\n  /**\n   * Refresh system\n   * @public\n   */\n  refresh() {\n    this.logger.debug(\"Refreshing AFS\");\n\n    this.items = this.container.querySelectorAll(\n      this.options.get(\"itemSelector\"),\n    );\n    this.state.setState(\"items.total\", this.items.length);\n\n    this.filter.applyFilters();\n    this.search.search(this.search.getValue());\n    this.pagination.update();\n\n    this.emit(\"refreshed\", { itemCount: this.items.length });\n  }\n\n  // Event Handlers\n  /**\n   * Handle resize\n   * @private\n   */\n  handleResize = debounce(() => {\n    this.emit(\"resize\");\n    this.refresh();\n  }, 250);\n\n  /**\n   * Handle visibility change\n   * @private\n   */\n  handleVisibilityChange() {\n    if (document.hidden) {\n      this.emit(\"hidden\");\n      this.saveState();\n    } else {\n      this.emit(\"visible\");\n      this.restoreState();\n    }\n  }\n\n  /**\n   * Setup mutation observer\n   * @private\n   */\n  setupMutationObserver() {\n    const observer = new MutationObserver((mutations) => {\n      if (mutations.some((mutation) => mutation.type === \"childList\")) {\n        this.refresh();\n      }\n    });\n\n    observer.observe(this.container, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  // Utility Methods\n  /**\n   * Get version\n   * @public\n   */\n  getVersion() {\n    return VERSION;\n  }\n\n  /**\n   * Check feature support\n   * @public\n   */\n  isFeatureSupported(feature) {\n    const supportedFeatures = {\n      search: !!this.search,\n      pagination: true,\n      animation:\n        typeof document.createElement(\"div\").style.transition !== \"undefined\",\n      urlState: typeof window.history.pushState === \"function\",\n      localStorage: (() => {\n        try {\n          localStorage.setItem(\"test\", \"test\");\n          localStorage.removeItem(\"test\");\n          return true;\n        } catch (e) {\n          return false;\n        }\n      })(),\n    };\n\n    return !!supportedFeatures[feature];\n  }\n\n  /**\n   * Destroy instance\n   * @public\n   */\n  destroy() {\n    this.logger.debug(\"Destroying AFS instance\");\n\n    // Remove event listeners\n    window.removeEventListener(\"resize\", this.handleResize);\n    document.removeEventListener(\n      \"visibilitychange\",\n      this.handleVisibilityChange,\n    );\n\n    // Destroy features\n    this.filter.destroy();\n    this.search.destroy();\n    this.sort.destroy();\n    this.pagination.destroy();\n    this.rangeFilter.destroy();\n\n    // Cleanup\n    this.styleManager.removeStyles();\n    this.state.reset();\n    localStorage.removeItem(\"afs_state\");\n\n    // Reset items\n    this.items.forEach((item) => {\n      item.style = \"\";\n      item.classList.remove(\n        this.options.get(\"hiddenClass\"),\n        this.options.get(\"activeClass\"),\n      );\n    });\n\n    this.emit(\"destroyed\");\n  }\n}\n"],"names":["Logger","constructor","debug","arguments","length","undefined","logLevel","this","enabled","level","levels","error","warn","info","_log","currentLevelValue","timestamp","Date","toISOString","prefix","toUpperCase","_len","args","Array","_key","console","_len2","_key2","_len3","_key3","_len4","_key4","_len5","_key5","setDebugMode","hasOwnProperty","Options","static","containerSelector","itemSelector","filterButtonSelector","searchInputSelector","counterSelector","activeClass","hiddenClass","animationDuration","animationType","animationEasing","filterMode","searchKeys","debounceTime","dateFormat","counter","template","showFiltered","filteredTemplate","noResultsTemplate","formatter","num","toLocaleString","styles","slider","class","trackClass","thumbClass","valueClass","selectedClass","ui","showHistogram","bins","colors","primary","background","text","histogram","histogramActive","pagination","itemsPerPage","pageButtonClass","activePageClass","containerClass","userOptions","options","mergeOptions","defaults","initializeStyles","validate","defaultStyles","currentStyles","target","source","result","key","isArray","requiredSelectors","selector","Error","includes","get","path","split","reduce","obj","set","value","parts","last","pop","update","updates","reset","export","State","state","filters","current","Set","groups","Map","ranges","dateRanges","mode","groupMode","search","query","keys","sort","orders","items","visible","total","currentPage","totalPages","getState","setState","i","from","entries","import","importedState","StyleManager","styleElement","animation","duration","type","createBaseStyles","createRangeStyles","sliderStyles","createDateStyles","applyStyles","createPaginationStyles","createSearchStyles","textContent","document","createElement","head","appendChild","fallbackStyles","paginationOptions","buttonClass","searchClass","updateStyles","newOptions","removeStyles","remove","EventEmitter","events","onceEvents","on","eventName","callback","has","add","off","once","_this","onceWrapper","apply","delete","size","emit","forEach","removeAllListeners","clear","listenerCount","Animation","afs","animations","fade","in","opacity","transform","transitionTimingFunction","out","slide","scale","rotate","flip","zoom","bounce","blur","filter","skew","slideInLeft","slideInRight","fadeInUp","fadeInDown","bounceIn","applyShowAnimation","item","style","display","requestAnimationFrame","Object","assign","transition","applyHideAnimation","handleTransitionEnd","removeEventListener","addEventListener","setAnimation","Filter","filterButtons","activeFilters","currentFilters","filterGroups","sortOrders","setupFilters","logger","filterSelector","querySelectorAll","button","filterValue","dataset","bindFilterEvent","setLogic","logic","applyFilters","clearAllFilters","_","classList","allButton","findAllButton","urlManager","updateURL","resetFilters","toggleFilter","visibleItems","handleFilterClick","contains","updateCounter","previouslyVisible","itemMatchesFilters","emitFilterEvents","container","offsetHeight","itemCategories","categories","itemMatchesFilterGroups","itemMatchesAnyFilter","itemMatchesAllFilters","some","every","groupMatches","values","map","group","operator","matches","nowVisible","added","removed","addFilterGroup","groupId","validOperator","removeFilterGroup","setGroupMode","validMode","addFilter","removeFilter","setFilterMode","getActiveFilters","getFilterGroups","addFilterButton","sortWithOrder","newOrder","sortType","determineSortType","a","b","valueA","getSortValue","valueB","compareValues","reorderItems","order","shuffle","j","Math","floor","random","itemCount","isNaN","test","parseFloat","getTime","toLowerCase","comparison","fragment","createDocumentFragment","getCurrentSortOrder","clearSortOrders","checkbox","checked","setValue","refresh","removeFilterButton","destroy","debounce","func","wait","timeout","immediate","context","callNow","clearTimeout","setTimeout","later","Search","searchInput","minSearchLength","highlightClass","setupSearch","searchSelector","querySelector","bindSearchEvents","debouncedSearch","e","clearSearch","preventDefault","normalizedQuery","normalizeQuery","regex","createSearchRegex","searchText","getItemSearchText","showItem","highlightMatches","hideItem","removeHighlights","trim","replace","pattern","Boolean","word","join","RegExp","words","highlightedText","wordRegex","innerHTML","highlight","replaceWith","getValue","updateConfig","handleClear","handleEnter","Sort","sortButtons","setupSort","sortSelector","sortKey","direction","sortDirection","bindSortEvent","sortData","updateSortButtonState","btn","indicator","modifier","sortMultiple","criteria","sortWithComparator","comparator","data","getCurrentSort","addSortButton","removeSortButton","Pagination","setupPagination","className","itemsContainer","parentNode","insertBefore","nextSibling","bindEvents","closest","page","goToPage","parseInt","ceil","updateVisibility","renderPagination","startIndex","endIndex","index","controls","createPaginationControls","showPrevNext","prevButton","createPageButton","disabled","active","range","calculatePageRange","start","createEllipsis","end","toString","nextButton","span","maxButtons","sideButtons","max","min","targetPage","scrollToTop","offset","scrollOffset","window","scrollTo","top","offsetTop","behavior","setItemsPerPage","count","getPageInfo","totalItems","hasNextPage","hasPrevPage","URLManager","defaultParams","URLSearchParams","setupPopStateHandler","loadFromURL","params","addFiltersToURL","addRangesToURL","addSearchToURL","addSortToURL","addPaginationToURL","pushState","filtersByType","_ref","currentMin","currentMax","queryString","newURL","location","pathname","href","history","filterParams","_ref2","isRegularFilter","_ref3","buttonFilter","searchQuery","sortParam","fromEntries","processFiltersFromURL","hasFilters","startsWith","processRangesFromURL","rangeKey","Number","str","processSearchFromURL","processSortFromURL","processPaginationFromURL","perPage","param","clearURL","getURLParams","hasParams","getParam","RangeFilter","activeRanges","styleManager","addRangeSlider","step","calculateMinMax","sliderUiOptions","histogramData","calculateHistogramData","counts","binEdges","elements","createSliderElements","initializeState","appendElements","setupEventHandlers","updateSliderUI","setupHistogramHighlight","track","createHistogramBars","selectedRange","minThumb","maxThumb","minValue","maxValue","createHistogram","bar","height","backgroundColor","binWidth","fill","binIndex","maxCount","round","bars","updateHistogram","minVal","maxVal","binStart","binEnd","isDragging","handleDragStart","isMin","moveHandler","createMoveHandler","stopHandler","applyFilter","minPos","maxPos","clampedMinPos","clampedMaxPos","left","width","formatValue","toLocaleDateString","toFixed","rect","getBoundingClientRect","totalWidth","paddingPixels","PADDING","rawPercent","clientX","percent","stepped","getRangeValues","setRangeValues","removeRangeSlider","DateFilter","activeDateRanges","defaultFormat","addDateRange","minDate","maxDate","format","dates","calculateMinMaxDates","createDateElements","updateDateUI","validDates","date","today","getFullYear","startContainer","startLabel","startInput","endContainer","endLabel","endInput","currentStartDate","currentEndDate","handleDateChange","startDate","endDate","applyDateFilter","formatDate","d","itemDate","setHours","compareDate","getDateRange","setDateRange","removeDateRange","VERSION","super","initializeCore","initializeDOM","initializeFeatures","setupLifecycle","rangeFilter","dateFilter","handleResize","bind","handleVisibilityChange","setupMutationObserver","transitionClass","addItems","newItems","removeItems","itemsToRemove","saveState","now","localStorage","setItem","JSON","stringify","restoreState","saved","getItem","parse","removeItem","newState","counterElement","filtered","counterOpts","formattedVisible","formattedTotal","formattedFiltered","counterText","updateOptions","hidden","MutationObserver","mutations","mutation","observe","childList","subtree","getVersion","isFeatureSupported","feature","urlState"],"mappings":"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"}